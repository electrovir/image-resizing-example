(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerpolicy&&(s.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?s.credentials="include":i.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function Pi(t){return t.replace(/\n/g," ").trim().replace(/\s{2,}/g," ")}const Ks={capitalizeFirstLetter:!1};function Bn(t){return t.length?t[0].toUpperCase()+t.slice(1):""}function zs(t,e){return e.capitalizeFirstLetter?Bn(t):t}function Ls(t,e=Ks){const n=t.toLowerCase();if(!n.length)return"";const r=n.replace(/^-+/,"").replace(/-{2,}/g,"-").replace(/-(?:.|$)/g,i=>{const s=i[1];return s?s.toUpperCase():""});return zs(r,e)}function Ir(t){return t!==t.toUpperCase()}function Hs(t){return t.split("").reduce((n,r,i,s)=>{const o=i>0?s[i-1]:"",a=i<s.length-1?s[i+1]:"",u=Ir(o)||Ir(a);return r===r.toLowerCase()||i===0||!u?n+=r:n+=`-${r.toLowerCase()}`,n},"").toLowerCase()}function Fs({value:t,min:e,max:n}){return Math.max(Math.min(t,n),e)}const Us=["january","february","march","april","may","june","july","august","september","october","november","december"];Us.map(t=>t.slice(0,3));function js(t){return!!t}const Vs=[(t,e)=>e in t,(t,e)=>e in t.constructor.prototype];function Ri(t,e){return t?Vs.some(n=>{try{return n(t,e)}catch{return!1}}):!1}function Ws(t,e){return t&&e.every(n=>Ri(t,n))}function Ut(t){const e=Se();return t!==1/0&&setTimeout(()=>{e.resolve()},t<=0?0:t),e.promise}function Gs(t){return!!(Ri(t,"then")&&typeof t.then=="function")}function Se(){let t,e,n=!1;const r=new Promise((i,s)=>{t=o=>(n=!0,i(o)),e=o=>{n=!0,s(o)}});if(!t||!e)throw new Error(`Reject and resolve callbacks were not set by the promise constructor for ${Se.name}.`);return{promise:r,resolve:t,reject:e,isSettled(){return n}}}function hn(t){return t?t instanceof Error?t.message:String(t):""}function Js(t){return t instanceof Error?t:new Error(hn(t))}function Ne(t){let e;try{e=Reflect.ownKeys(t)}catch{}return e??[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}function Kr(t){return Object.entries(t).sort((e,n)=>e[0].localeCompare(n[0]))}function ki(t,e){return Ne(t).filter(r=>{const i=t[r];return e(r,i,t)}).reduce((r,i)=>(r[i]=t[i],r),{})}function Ee(t,e){let n=!1;const r=Ne(t).reduce((i,s)=>{const o=e(s,t[s],t);return o instanceof Promise&&(n=!0),{...i,[s]:o}},{});return n?new Promise(async(i,s)=>{try{await Promise.all(Ne(r).map(async o=>{const a=await r[o];r[o]=a})),i(r)}catch(o){s(o)}}):r}function zr(t){return!!t&&typeof t=="object"}function Di(t,e){try{if(t===e)return!0;if(zr(t)&&zr(e)){const n=Kr(t),r=Kr(e);return JSON.stringify(n)===JSON.stringify(r)}else return JSON.stringify(t)===JSON.stringify(e)}catch(n){throw console.error(`Failed to compare objects using JSON.stringify: ${hn(n)}`),n}}async function Ys(t){const e=Se(),n=new Image;return n.onload=()=>{e.resolve(n)},n.onerror=()=>{e.reject(new Error(`Failed to load '${t}'`))},n.src=t,e.promise}function ne(t){return String(t).endsWith("px")?String(t):`${t}px`}async function qs(t){const e=Se(),n=document.createElement("video");return n.addEventListener("loadeddata",()=>{e.resolve(n)}),n.onerror=()=>{e.reject(new Error(`Failed to load '${t}'`))},n.src=t,n.load(),e.promise}/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const jt=window,dr=jt.ShadowRoot&&(jt.ShadyCSS===void 0||jt.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,pr=Symbol(),Lr=new WeakMap;let Oi=class{constructor(e,n,r){if(this._$cssResult$=!0,r!==pr)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=n}get styleSheet(){let e=this.o;const n=this.t;if(dr&&e===void 0){const r=n!==void 0&&n.length===1;r&&(e=Lr.get(n)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),r&&Lr.set(n,e))}return e}toString(){return this.cssText}};const dt=t=>new Oi(typeof t=="string"?t:t+"",void 0,pr),Mi=(t,...e)=>{const n=t.length===1?t[0]:e.reduce((r,i,s)=>r+(o=>{if(o._$cssResult$===!0)return o.cssText;if(typeof o=="number")return o;throw Error("Value passed to 'css' function must be a 'css' function result: "+o+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(i)+t[s+1],t[0]);return new Oi(n,t,pr)},Qs=(t,e)=>{dr?t.adoptedStyleSheets=e.map(n=>n instanceof CSSStyleSheet?n:n.styleSheet):e.forEach(n=>{const r=document.createElement("style"),i=jt.litNonce;i!==void 0&&r.setAttribute("nonce",i),r.textContent=n.cssText,t.appendChild(r)})},Hr=dr?t=>t:t=>t instanceof CSSStyleSheet?(e=>{let n="";for(const r of e.cssRules)n+=r.cssText;return dt(n)})(t):t;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var wn;const Xt=window,Fr=Xt.trustedTypes,Xs=Fr?Fr.emptyScript:"",Ur=Xt.reactiveElementPolyfillSupport,Nn={toAttribute(t,e){switch(e){case Boolean:t=t?Xs:null;break;case Object:case Array:t=t==null?t:JSON.stringify(t)}return t},fromAttribute(t,e){let n=t;switch(e){case Boolean:n=t!==null;break;case Number:n=t===null?null:Number(t);break;case Object:case Array:try{n=JSON.parse(t)}catch{n=null}}return n}},Bi=(t,e)=>e!==t&&(e==e||t==t),bn={attribute:!0,type:String,converter:Nn,reflect:!1,hasChanged:Bi};let Fe=class extends HTMLElement{constructor(){super(),this._$Ei=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$El=null,this.u()}static addInitializer(e){var n;this.finalize(),((n=this.h)!==null&&n!==void 0?n:this.h=[]).push(e)}static get observedAttributes(){this.finalize();const e=[];return this.elementProperties.forEach((n,r)=>{const i=this._$Ep(r,n);i!==void 0&&(this._$Ev.set(i,r),e.push(i))}),e}static createProperty(e,n=bn){if(n.state&&(n.attribute=!1),this.finalize(),this.elementProperties.set(e,n),!n.noAccessor&&!this.prototype.hasOwnProperty(e)){const r=typeof e=="symbol"?Symbol():"__"+e,i=this.getPropertyDescriptor(e,r,n);i!==void 0&&Object.defineProperty(this.prototype,e,i)}}static getPropertyDescriptor(e,n,r){return{get(){return this[n]},set(i){const s=this[e];this[n]=i,this.requestUpdate(e,s,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)||bn}static finalize(){if(this.hasOwnProperty("finalized"))return!1;this.finalized=!0;const e=Object.getPrototypeOf(this);if(e.finalize(),e.h!==void 0&&(this.h=[...e.h]),this.elementProperties=new Map(e.elementProperties),this._$Ev=new Map,this.hasOwnProperty("properties")){const n=this.properties,r=[...Object.getOwnPropertyNames(n),...Object.getOwnPropertySymbols(n)];for(const i of r)this.createProperty(i,n[i])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(e){const n=[];if(Array.isArray(e)){const r=new Set(e.flat(1/0).reverse());for(const i of r)n.unshift(Hr(i))}else e!==void 0&&n.push(Hr(e));return n}static _$Ep(e,n){const r=n.attribute;return r===!1?void 0:typeof r=="string"?r:typeof e=="string"?e.toLowerCase():void 0}u(){var e;this._$E_=new Promise(n=>this.enableUpdating=n),this._$AL=new Map,this._$Eg(),this.requestUpdate(),(e=this.constructor.h)===null||e===void 0||e.forEach(n=>n(this))}addController(e){var n,r;((n=this._$ES)!==null&&n!==void 0?n:this._$ES=[]).push(e),this.renderRoot!==void 0&&this.isConnected&&((r=e.hostConnected)===null||r===void 0||r.call(e))}removeController(e){var n;(n=this._$ES)===null||n===void 0||n.splice(this._$ES.indexOf(e)>>>0,1)}_$Eg(){this.constructor.elementProperties.forEach((e,n)=>{this.hasOwnProperty(n)&&(this._$Ei.set(n,this[n]),delete this[n])})}createRenderRoot(){var e;const n=(e=this.shadowRoot)!==null&&e!==void 0?e:this.attachShadow(this.constructor.shadowRootOptions);return Qs(n,this.constructor.elementStyles),n}connectedCallback(){var e;this.renderRoot===void 0&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(e=this._$ES)===null||e===void 0||e.forEach(n=>{var r;return(r=n.hostConnected)===null||r===void 0?void 0:r.call(n)})}enableUpdating(e){}disconnectedCallback(){var e;(e=this._$ES)===null||e===void 0||e.forEach(n=>{var r;return(r=n.hostDisconnected)===null||r===void 0?void 0:r.call(n)})}attributeChangedCallback(e,n,r){this._$AK(e,r)}_$EO(e,n,r=bn){var i;const s=this.constructor._$Ep(e,r);if(s!==void 0&&r.reflect===!0){const o=(((i=r.converter)===null||i===void 0?void 0:i.toAttribute)!==void 0?r.converter:Nn).toAttribute(n,r.type);this._$El=e,o==null?this.removeAttribute(s):this.setAttribute(s,o),this._$El=null}}_$AK(e,n){var r;const i=this.constructor,s=i._$Ev.get(e);if(s!==void 0&&this._$El!==s){const o=i.getPropertyOptions(s),a=typeof o.converter=="function"?{fromAttribute:o.converter}:((r=o.converter)===null||r===void 0?void 0:r.fromAttribute)!==void 0?o.converter:Nn;this._$El=s,this[s]=a.fromAttribute(n,o.type),this._$El=null}}requestUpdate(e,n,r){let i=!0;e!==void 0&&(((r=r||this.constructor.getPropertyOptions(e)).hasChanged||Bi)(this[e],n)?(this._$AL.has(e)||this._$AL.set(e,n),r.reflect===!0&&this._$El!==e&&(this._$EC===void 0&&(this._$EC=new Map),this._$EC.set(e,r))):i=!1),!this.isUpdatePending&&i&&(this._$E_=this._$Ej())}async _$Ej(){this.isUpdatePending=!0;try{await this._$E_}catch(n){Promise.reject(n)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var e;if(!this.isUpdatePending)return;this.hasUpdated,this._$Ei&&(this._$Ei.forEach((i,s)=>this[s]=i),this._$Ei=void 0);let n=!1;const r=this._$AL;try{n=this.shouldUpdate(r),n?(this.willUpdate(r),(e=this._$ES)===null||e===void 0||e.forEach(i=>{var s;return(s=i.hostUpdate)===null||s===void 0?void 0:s.call(i)}),this.update(r)):this._$Ek()}catch(i){throw n=!1,this._$Ek(),i}n&&this._$AE(r)}willUpdate(e){}_$AE(e){var n;(n=this._$ES)===null||n===void 0||n.forEach(r=>{var i;return(i=r.hostUpdated)===null||i===void 0?void 0:i.call(r)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$Ek(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$E_}shouldUpdate(e){return!0}update(e){this._$EC!==void 0&&(this._$EC.forEach((n,r)=>this._$EO(r,this[r],n)),this._$EC=void 0),this._$Ek()}updated(e){}firstUpdated(e){}};Fe.finalized=!0,Fe.elementProperties=new Map,Fe.elementStyles=[],Fe.shadowRootOptions={mode:"open"},Ur==null||Ur({ReactiveElement:Fe}),((wn=Xt.reactiveElementVersions)!==null&&wn!==void 0?wn:Xt.reactiveElementVersions=[]).push("1.6.1");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var _n;const Zt=window,Je=Zt.trustedTypes,jr=Je?Je.createPolicy("lit-html",{createHTML:t=>t}):void 0,be=`lit$${(Math.random()+"").slice(9)}$`,Ni="?"+be,Zs=`<${Ni}>`,Ye=document,pt=(t="")=>Ye.createComment(t),vt=t=>t===null||typeof t!="object"&&typeof t!="function",Ii=Array.isArray,eo=t=>Ii(t)||typeof(t==null?void 0:t[Symbol.iterator])=="function",rt=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,Vr=/-->/g,Wr=/>/g,Te=RegExp(`>|[ 	
\f\r](?:([^\\s"'>=/]+)([ 	
\f\r]*=[ 	
\f\r]*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),Gr=/'/g,Jr=/"/g,Ki=/^(?:script|style|textarea|title)$/i,to=t=>(e,...n)=>({_$litType$:t,strings:e,values:n}),no=to(1),xe=Symbol.for("lit-noChange"),H=Symbol.for("lit-nothing"),Yr=new WeakMap,We=Ye.createTreeWalker(Ye,129,null,!1),ro=(t,e)=>{const n=t.length-1,r=[];let i,s=e===2?"<svg>":"",o=rt;for(let u=0;u<n;u++){const l=t[u];let f,c,h=-1,m=0;for(;m<l.length&&(o.lastIndex=m,c=o.exec(l),c!==null);)m=o.lastIndex,o===rt?c[1]==="!--"?o=Vr:c[1]!==void 0?o=Wr:c[2]!==void 0?(Ki.test(c[2])&&(i=RegExp("</"+c[2],"g")),o=Te):c[3]!==void 0&&(o=Te):o===Te?c[0]===">"?(o=i??rt,h=-1):c[1]===void 0?h=-2:(h=o.lastIndex-c[2].length,f=c[1],o=c[3]===void 0?Te:c[3]==='"'?Jr:Gr):o===Jr||o===Gr?o=Te:o===Vr||o===Wr?o=rt:(o=Te,i=void 0);const p=o===Te&&t[u+1].startsWith("/>")?" ":"";s+=o===rt?l+Zs:h>=0?(r.push(f),l.slice(0,h)+"$lit$"+l.slice(h)+be+p):l+be+(h===-2?(r.push(void 0),u):p)}const a=s+(t[n]||"<?>")+(e===2?"</svg>":"");if(!Array.isArray(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return[jr!==void 0?jr.createHTML(a):a,r]};class mt{constructor({strings:e,_$litType$:n},r){let i;this.parts=[];let s=0,o=0;const a=e.length-1,u=this.parts,[l,f]=ro(e,n);if(this.el=mt.createElement(l,r),We.currentNode=this.el.content,n===2){const c=this.el.content,h=c.firstChild;h.remove(),c.append(...h.childNodes)}for(;(i=We.nextNode())!==null&&u.length<a;){if(i.nodeType===1){if(i.hasAttributes()){const c=[];for(const h of i.getAttributeNames())if(h.endsWith("$lit$")||h.startsWith(be)){const m=f[o++];if(c.push(h),m!==void 0){const p=i.getAttribute(m.toLowerCase()+"$lit$").split(be),d=/([.?@])?(.*)/.exec(m);u.push({type:1,index:s,name:d[2],strings:p,ctor:d[1]==="."?so:d[1]==="?"?ao:d[1]==="@"?uo:dn})}else u.push({type:6,index:s})}for(const h of c)i.removeAttribute(h)}if(Ki.test(i.tagName)){const c=i.textContent.split(be),h=c.length-1;if(h>0){i.textContent=Je?Je.emptyScript:"";for(let m=0;m<h;m++)i.append(c[m],pt()),We.nextNode(),u.push({type:2,index:++s});i.append(c[h],pt())}}}else if(i.nodeType===8)if(i.data===Ni)u.push({type:2,index:s});else{let c=-1;for(;(c=i.data.indexOf(be,c+1))!==-1;)u.push({type:7,index:s}),c+=be.length-1}s++}}static createElement(e,n){const r=Ye.createElement("template");return r.innerHTML=e,r}}function qe(t,e,n=t,r){var i,s,o,a;if(e===xe)return e;let u=r!==void 0?(i=n._$Co)===null||i===void 0?void 0:i[r]:n._$Cl;const l=vt(e)?void 0:e._$litDirective$;return(u==null?void 0:u.constructor)!==l&&((s=u==null?void 0:u._$AO)===null||s===void 0||s.call(u,!1),l===void 0?u=void 0:(u=new l(t),u._$AT(t,n,r)),r!==void 0?((o=(a=n)._$Co)!==null&&o!==void 0?o:a._$Co=[])[r]=u:n._$Cl=u),u!==void 0&&(e=qe(t,u._$AS(t,e.values),u,r)),e}class io{constructor(e,n){this.u=[],this._$AN=void 0,this._$AD=e,this._$AM=n}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}v(e){var n;const{el:{content:r},parts:i}=this._$AD,s=((n=e==null?void 0:e.creationScope)!==null&&n!==void 0?n:Ye).importNode(r,!0);We.currentNode=s;let o=We.nextNode(),a=0,u=0,l=i[0];for(;l!==void 0;){if(a===l.index){let f;l.type===2?f=new $t(o,o.nextSibling,this,e):l.type===1?f=new l.ctor(o,l.name,l.strings,this,e):l.type===6&&(f=new lo(o,this,e)),this.u.push(f),l=i[++u]}a!==(l==null?void 0:l.index)&&(o=We.nextNode(),a++)}return s}p(e){let n=0;for(const r of this.u)r!==void 0&&(r.strings!==void 0?(r._$AI(e,r,n),n+=r.strings.length-2):r._$AI(e[n])),n++}}class $t{constructor(e,n,r,i){var s;this.type=2,this._$AH=H,this._$AN=void 0,this._$AA=e,this._$AB=n,this._$AM=r,this.options=i,this._$Cm=(s=i==null?void 0:i.isConnected)===null||s===void 0||s}get _$AU(){var e,n;return(n=(e=this._$AM)===null||e===void 0?void 0:e._$AU)!==null&&n!==void 0?n:this._$Cm}get parentNode(){let e=this._$AA.parentNode;const n=this._$AM;return n!==void 0&&e.nodeType===11&&(e=n.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,n=this){e=qe(this,e,n),vt(e)?e===H||e==null||e===""?(this._$AH!==H&&this._$AR(),this._$AH=H):e!==this._$AH&&e!==xe&&this.g(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):eo(e)?this.k(e):this.g(e)}O(e,n=this._$AB){return this._$AA.parentNode.insertBefore(e,n)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}g(e){this._$AH!==H&&vt(this._$AH)?this._$AA.nextSibling.data=e:this.T(Ye.createTextNode(e)),this._$AH=e}$(e){var n;const{values:r,_$litType$:i}=e,s=typeof i=="number"?this._$AC(e):(i.el===void 0&&(i.el=mt.createElement(i.h,this.options)),i);if(((n=this._$AH)===null||n===void 0?void 0:n._$AD)===s)this._$AH.p(r);else{const o=new io(s,this),a=o.v(this.options);o.p(r),this.T(a),this._$AH=o}}_$AC(e){let n=Yr.get(e.strings);return n===void 0&&Yr.set(e.strings,n=new mt(e)),n}k(e){Ii(this._$AH)||(this._$AH=[],this._$AR());const n=this._$AH;let r,i=0;for(const s of e)i===n.length?n.push(r=new $t(this.O(pt()),this.O(pt()),this,this.options)):r=n[i],r._$AI(s),i++;i<n.length&&(this._$AR(r&&r._$AB.nextSibling,i),n.length=i)}_$AR(e=this._$AA.nextSibling,n){var r;for((r=this._$AP)===null||r===void 0||r.call(this,!1,!0,n);e&&e!==this._$AB;){const i=e.nextSibling;e.remove(),e=i}}setConnected(e){var n;this._$AM===void 0&&(this._$Cm=e,(n=this._$AP)===null||n===void 0||n.call(this,e))}}class dn{constructor(e,n,r,i,s){this.type=1,this._$AH=H,this._$AN=void 0,this.element=e,this.name=n,this._$AM=i,this.options=s,r.length>2||r[0]!==""||r[1]!==""?(this._$AH=Array(r.length-1).fill(new String),this.strings=r):this._$AH=H}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(e,n=this,r,i){const s=this.strings;let o=!1;if(s===void 0)e=qe(this,e,n,0),o=!vt(e)||e!==this._$AH&&e!==xe,o&&(this._$AH=e);else{const a=e;let u,l;for(e=s[0],u=0;u<s.length-1;u++)l=qe(this,a[r+u],n,u),l===xe&&(l=this._$AH[u]),o||(o=!vt(l)||l!==this._$AH[u]),l===H?e=H:e!==H&&(e+=(l??"")+s[u+1]),this._$AH[u]=l}o&&!i&&this.j(e)}j(e){e===H?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class so extends dn{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===H?void 0:e}}const oo=Je?Je.emptyScript:"";class ao extends dn{constructor(){super(...arguments),this.type=4}j(e){e&&e!==H?this.element.setAttribute(this.name,oo):this.element.removeAttribute(this.name)}}class uo extends dn{constructor(e,n,r,i,s){super(e,n,r,i,s),this.type=5}_$AI(e,n=this){var r;if((e=(r=qe(this,e,n,0))!==null&&r!==void 0?r:H)===xe)return;const i=this._$AH,s=e===H&&i!==H||e.capture!==i.capture||e.once!==i.once||e.passive!==i.passive,o=e!==H&&(i===H||s);s&&this.element.removeEventListener(this.name,this,i),o&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var n,r;typeof this._$AH=="function"?this._$AH.call((r=(n=this.options)===null||n===void 0?void 0:n.host)!==null&&r!==void 0?r:this.element,e):this._$AH.handleEvent(e)}}class lo{constructor(e,n,r){this.element=e,this.type=6,this._$AN=void 0,this._$AM=n,this.options=r}get _$AU(){return this._$AM._$AU}_$AI(e){qe(this,e)}}const qr=Zt.litHtmlPolyfillSupport;qr==null||qr(mt,$t),((_n=Zt.litHtmlVersions)!==null&&_n!==void 0?_n:Zt.litHtmlVersions=[]).push("2.6.1");const co=(t,e,n)=>{var r,i;const s=(r=n==null?void 0:n.renderBefore)!==null&&r!==void 0?r:e;let o=s._$litPart$;if(o===void 0){const a=(i=n==null?void 0:n.renderBefore)!==null&&i!==void 0?i:null;s._$litPart$=o=new $t(e.insertBefore(pt(),a),a,void 0,n??{})}return o._$AI(t),o};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var Sn,En;class at extends Fe{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var e,n;const r=super.createRenderRoot();return(e=(n=this.renderOptions).renderBefore)!==null&&e!==void 0||(n.renderBefore=r.firstChild),r}update(e){const n=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=co(n,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),(e=this._$Do)===null||e===void 0||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),(e=this._$Do)===null||e===void 0||e.setConnected(!1)}render(){return xe}}at.finalized=!0,at._$litElement$=!0,(Sn=globalThis.litElementHydrateSupport)===null||Sn===void 0||Sn.call(globalThis,{LitElement:at});const Qr=globalThis.litElementPolyfillSupport;Qr==null||Qr({LitElement:at});((En=globalThis.litElementVersions)!==null&&En!==void 0?En:globalThis.litElementVersions=[]).push("3.2.2");var fo=globalThis&&globalThis.__decorate||function(t,e,n,r){var i=arguments.length,s=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s};function ho(){return t=>{}}let yt=class extends at{};yt=fo([ho()],yt);/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const po=(t,e)=>e.kind==="method"&&e.descriptor&&!("value"in e.descriptor)?{...e,finisher(n){n.createProperty(e.key,t)}}:{kind:"field",key:Symbol(),placement:"own",descriptor:{},originalKey:e.key,initializer(){typeof e.initializer=="function"&&(this[e.key]=e.initializer.call(this))},finisher(n){n.createProperty(e.key,t)}};function Xr(t){return(e,n)=>n!==void 0?((r,i,s)=>{i.constructor.createProperty(s,r)})(t,e,n):po(t,e)}/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var xn;((xn=window.HTMLSlotElement)===null||xn===void 0?void 0:xn.prototype.assignedElements)!=null;const In=Symbol("this-is-an-element-vir-declarative-element"),vr=Symbol("key for ignoring inputs not having been set yet"),vo={[vr]:!0};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const mo={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4,EVENT:5,ELEMENT:6},mr=t=>(...e)=>({_$litDirective$:t,values:e});class yr{constructor(e){}get _$AU(){return this._$AM._$AU}_$AT(e,n,r){this._$Ct=e,this._$AM=n,this._$Ci=r}_$AS(e,n){return this.update(e,n)}update(e,n){return this.render(...n)}}function yo(t,e){return zi(t,e,yt)}function zi(t,e,n){Kn(t,e);const r=t.element;if(!(r instanceof n))throw new Error(`${e} attached to non ${n.name} element.`);return r}function Kn(t,e){if(t.type!==mo.ELEMENT)throw new Error(`${e} directive can only be attached directly to an element.`);if(!t.element)throw new Error(`${e} directive found no element.`)}function gr(t,e){return go(t,e)}const go=mr(class extends yr{constructor(t){super(t),this.element=yo(t,"assign")}render(t,e){return wo(t,this.element,e),xe}});function wo(t,e,n){if(e.tagName.toLowerCase()!==t.tagName.toLowerCase())throw console.error(e,t),new Error(`Assignment mismatch. Assignment was made for ${e.tagName.toLowerCase()} but it's attached to ${t.tagName.toLowerCase()}`);e.assignInputs(n)}function Li(t){const e=t.getRootNode();if(!(e instanceof ShadowRoot))return!1;const n=e.host;return n instanceof yt?!0:Li(n)}var O=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},q=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,n,r,i){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?i.call(t,n):i?i.value=n:e.set(t,n),n},ae,Pe,ke,De,Ve,Ue,G,ut,zn,Ln;function bo(t){if(!t)return{};const e=ki(t,(r,i)=>i instanceof Hi);return Ee(e,(r,i)=>new _o(i.initialValue))}const Bt=Symbol("not set");class _o{constructor(e){ae.add(this),Pe.set(this,Bt),ke.set(this,void 0),De.set(this,void 0),Ve.set(this,[]),Ue.set(this,void 0),G.set(this,Se()),e&&this.setValue({newPromise:e})}setValue(e){if("createPromise"in e){if(O(this,Pe,"f")===Bt||!Di(e.trigger,O(this,Pe,"f"))){q(this,Pe,e.trigger,"f");const n=e.createPromise();O(this,ae,"m",zn).call(this,n)}}else"newPromise"in e?(O(this,Pe,"f"),O(this,ae,"m",zn).call(this,e.newPromise),O(this,ae,"m",ut).call(this)):"resolvedValue"in e?O(this,ae,"m",Ln).call(this,e.resolvedValue):e.forceUpdate&&(q(this,Pe,Bt,"f"),q(this,ke,void 0,"f"),O(this,G,"f").isSettled()||O(this,G,"f").reject("Canceled by force update"),q(this,G,Se(),"f"),O(this,ae,"m",ut).call(this))}getValue(){return O(this,G,"f").isSettled()?O(this,De,"f")?O(this,De,"f"):O(this,ke,"f"):O(this,G,"f").promise}addSettleListener(e){O(this,Ve,"f").push(e)}removeSettleListener(e){q(this,Ve,O(this,Ve,"f").filter(n=>n!==e),"f")}}Pe=new WeakMap,ke=new WeakMap,De=new WeakMap,Ve=new WeakMap,Ue=new WeakMap,G=new WeakMap,ae=new WeakSet,ut=function(){O(this,Ve,"f").forEach(e=>{e()})},zn=function(e){e!==O(this,Ue,"f")&&(q(this,ke,void 0,"f"),q(this,De,void 0,"f"),q(this,Ue,e,"f"),O(this,G,"f").isSettled()&&q(this,G,Se(),"f"),e.then(n=>{O(this,Ue,"f")===e&&O(this,ae,"m",Ln).call(this,n)}).catch(n=>{O(this,Ue,"f")===e&&(q(this,De,Js(n),"f"),O(this,G,"f").promise.catch(()=>{}),O(this,G,"f").reject(n),O(this,ae,"m",ut).call(this))}))},Ln=function(e){e!==O(this,ke,"f")&&(q(this,De,void 0,"f"),q(this,ke,e,"f"),O(this,G,"f").isSettled()&&q(this,G,Se(),"f"),O(this,G,"f").resolve(e),O(this,ae,"m",ut).call(this))};class Hi{constructor(e){this.initialValue=e}}function Fi(t){return new Hi(t)}function Ui(t,e){return`${t}-${Hs(e)}`}function So(t,e){return e?Ee(e,n=>dt(`--${Ui(t,String(n))}`)):{}}function Eo(t,e){return t?Ee(t,(n,r)=>{const i=e[n];return dt(`var(${i}, ${r})`)}):{}}class xo extends CustomEvent{get type(){return this._type}constructor(e,n){super(typeof e=="string"?e:e.type,{detail:n,bubbles:!0,composed:!0}),this._type=""}}function ji(){return t=>{var e;return e=class extends xo{constructor(n){super(t,n),this._type=t}},e.type=t,e}}function Ao(){return ji()}function $o(t){return t?Object.keys(t).filter(e=>{if(typeof e!="string")throw new Error(`Expected event key of type string but got type "${typeof e}" for key ${String(e)}`);if(e==="")throw new Error("Got empty string for events key.");return!0}).reduce((e,n)=>{const r=ji()(n);return e[n]=r,e},{}):{}}function Zr(t,e,n){if(typeof t!="string"&&typeof t!="number"&&typeof t!="symbol")throw new Error(`Property name must be a string, got type '${typeof t}' from: '${String(t)}' for '${n.toLowerCase()}'`);if(!(t in e))throw new Error(`Property '${String(t)}' does not exist on '${n.toLowerCase()}'.`)}function ei(t,e){const n=t;function r(s,o){e&&Zr(o,t,t.tagName);const a=t.asyncStateHandlerMap[o];return a?a.getValue():n[o]}return new Proxy({},{get:r,set:(s,o,a)=>{e&&Zr(o,t,t.tagName),s[o]=void 0;const u=t.asyncStateHandlerMap[o];return u?u.setValue(a):n[o]=a,!0},ownKeys:s=>Reflect.ownKeys(s),getOwnPropertyDescriptor(s,o){if(o in s)return{get value(){return r(s,o)},configurable:!0,enumerable:!0}},has:(s,o)=>Reflect.has(s,o)})}function Co(t,e){return e?Ee(e,n=>Ui(t,String(n))):{}}function To({hostClassNames:t,cssVarNames:e,cssVarValues:n}){return{hostClassSelectors:Ee(t,(r,i)=>dt(`:host(.${i})`)),hostClassNames:Ee(t,(r,i)=>dt(i)),cssVarNames:e,cssVarValues:n}}function Po({host:t,hostClassesInit:e,hostClassNames:n,state:r,inputs:i}){e&&Ne(e).forEach(s=>{const o=e[s],a=n[s];typeof o=="function"&&(o({state:r,inputs:i})?t.classList.add(a):t.classList.remove(a))})}function Ro(t,e){function n(i){Ne(i).forEach(s=>{const o=i[s],a=t.asyncStateHandlerMap[s];a?a.setValue(o):t.instanceState[s]=o})}return{dispatch:i=>t.dispatchEvent(i),updateState:n,inputs:t.instanceInputs,host:t,state:t.instanceState,events:e}}function wr(t){var e;const n=$o(t.events),r=Co(t.tagName,t.hostClasses),i=So(t.tagName,t.cssVars),s=Eo(t.cssVars,i),o={...vo,...t.options},a=typeof t.styles=="function"?t.styles(To({hostClassNames:r,cssVarNames:i,cssVarValues:s})):t.styles||Mi``,u=t.renderCallback,l=(e=class extends yt{createRenderParams(){return Ro(this,n)}get instanceType(){throw new Error(`"instanceType" was called on ${t.tagName} as a value but it is only for types.`)}static get inputsType(){throw new Error(`"inputsType" was called on ${t.tagName} as a value but it is only for types.`)}static get stateType(){throw new Error(`"stateType" was called on ${t.tagName} as a value but it is only for types.`)}markInputsAsHavingBeenSet(){this.haveInputsBeenSet||(this.haveInputsBeenSet=!0)}render(){Li(this)&&!this.haveInputsBeenSet&&!o[vr]&&console.warn(this,`${t.tagName} got rendered before its input object was set. This was most likely caused by forgetting to use the "${gr.name}" directive on it. If no inputs are intended, use "${wr.name}" to define ${t.tagName}.`);const f=this.createRenderParams();!this.initCalled&&t.initCallback&&(this.initCalled=!0,t.initCallback(f));const c=t.renderCallback(f);return Po({host:f.host,hostClassesInit:t.hostClasses,hostClassNames:r,state:f.state,inputs:f.inputs}),c}disconnectedCallback(){if(super.disconnectedCallback(),t.cleanupCallback){const f=this.createRenderParams();t.cleanupCallback(f)}this.initCalled=!1}assignInputs(f){Ne(f).forEach(c=>{Xr()(this,c),this.instanceInputs[c]=f[c]}),this.markInputsAsHavingBeenSet()}constructor(){super(),this.initCalled=!1,this.haveInputsBeenSet=!1,this.definition={},this.asyncStateHandlerMap=bo(t.stateInit),this.instanceInputs=ei(this,!1),this.instanceState=ei(this,!0);const f=t.stateInit||{};Ne(f).forEach(c=>{Xr()(this,c);const h=this.asyncStateHandlerMap[c];h?(this.instanceState[c]=h.getValue(),h.addSettleListener(()=>{this[c]=h.getValue()})):this.instanceState[c]=f[c]}),this.definition=l}},e.tagName=t.tagName,e.styles=a,e.isStrictInstance=()=>!1,e.events=n,e.renderCallback=u,e.hostClasses=r,e.cssVarNames=i,e.stateInit=t.stateInit,e.cssVarValues=i,e);return Object.defineProperties(l,{[In]:{value:!0,writable:!1},name:{value:Ls(t.tagName,{capitalizeFirstLetter:!0}),writable:!0},isStrictInstance:{value:f=>f instanceof l,writable:!1}}),window.customElements.get(t.tagName)?console.warn(`Tried to define custom element '${t.tagName}' but it is already defined.`):window.customElements.define(t.tagName,l),l}function Vi(){return t=>wr({...t,options:{[vr]:!1},...t.options})}function en(t,e){return ko(t,e)}const ko=mr(class extends yr{constructor(t){super(t),this.element=zi(t,"listen",HTMLElement)}resetListener(t){this.lastListenerMetaData&&this.element.removeEventListener(this.lastListenerMetaData.eventType,this.lastListenerMetaData.listener),this.element.addEventListener(t.eventType,t.listener),this.lastListenerMetaData=t}createListenerMetaData(t,e){return{eventType:t,callback:e,listener:n=>{var r;return(r=this.lastListenerMetaData)===null||r===void 0?void 0:r.callback(n)}}}render(t,e){const n=typeof t=="string"?t:t.type;if(typeof n!="string")throw new Error(`Cannot listen to an event with a name that is not a string. Given event name: "${n}"`);return this.lastListenerMetaData&&this.lastListenerMetaData.eventType===n?this.lastListenerMetaData.callback=e:this.resetListener(this.createListenerMetaData(n,e)),xe}}),ti="onDomCreated",Do=mr(class extends yr{constructor(t){super(t),Kn(t,ti)}update(t,[e]){Kn(t,ti);const n=t.element;return n!==this.element&&(requestAnimationFrame(()=>e(n)),this.element=n),this.render(e)}render(t){}});function Hn(t,e,n,r){return t instanceof Error?r?r(t):hn(t):Gs(t)?e:n?n(t):t}function Oo(t){var e,n;const{assertInputs:r,transformInputs:i}={assertInputs:(e=t==null?void 0:t.assertInputs)!==null&&e!==void 0?e:()=>{},transformInputs:(n=t==null?void 0:t.transformInputs)!==null&&n!==void 0?n:s=>s};return{defineElement:()=>s=>(r(s),Vi()(i(s))),defineElementNoInputs:s=>(r(s),wr(i(s)))}}function Mo(t,e){return t.filter((n,r)=>!e.includes(r))}function Wi(t){return t.filter(e=>Ws(e,["tagName",In])&&!!e.tagName&&!!e[In])}const Gi=new WeakMap;function Bo(t,e){var n;const r=Wi(e);return(n=Ji(Gi,[t,...r]).value)===null||n===void 0?void 0:n.template}function No(t,e,n){const r=Wi(e);return qi(Gi,[t,...r],n)}function Ji(t,e,n=0){const{currentTemplateAndNested:r,reason:i}=Yi(t,e,n);return r?n===e.length-1?{value:r,reason:"reached end of keys array"}:r.nested?Ji(r.nested,e,n+1):{value:void 0,reason:`map at key index ${n} did not have nested maps`}:{value:r,reason:i}}function Yi(t,e,n){const r=e[n];if(r==null)return{currentKey:void 0,currentTemplateAndNested:void 0,reason:`key at index ${n} not found`};if(!t.has(r))return{currentKey:r,currentTemplateAndNested:void 0,reason:`key at index ${n} was not in the map`};const i=t.get(r);return i==null?{currentKey:r,currentTemplateAndNested:void 0,reason:`value at key at index ${n} was undefined`}:{currentKey:r,currentTemplateAndNested:i,reason:"key and value exists"}}function qi(t,e,n,r=0){var i;const{currentTemplateAndNested:s,currentKey:o,reason:a}=Yi(t,e,r);if(!o)return{result:!1,reason:a};const u=s??{nested:void 0,template:void 0};if(s||t.set(o,u),r===e.length-1)return u.template=n,{result:!0,reason:"set value at end of keys array"};const l=(i=u.nested)!==null&&i!==void 0?i:new WeakMap;return u.nested||(u.nested=l),qi(l,e,n,r+1)}function Qi(t,e,n){return{name:t,check:e,transform:n}}const Io=new WeakMap;function Xi(t,e,n){const r=Bo(t,e),i=r??n();if(!r){const o=No(t,e,i);if(o.result)Io.set(t,i);else throw new Error(`Failed to set template transform: ${o.reason}`)}const s=Mo(e,i.valueIndexDeletions);return{strings:i.templateStrings,values:s}}function Zi(t,e,n,r){const i=[],s=[],o=[];return t.forEach((u,l)=>{var f;const c=i.length-1,h=i[c],m=l-1,p=e[m];let d;r&&r(u),typeof h=="string"&&(d=(f=n.find(b=>b.check(h,u,p)))===null||f===void 0?void 0:f.transform,d&&(i[c]=h+d(p)+u,o.push(m))),d||i.push(u);const y=t.raw[l];d?s[c]=s[c]+d(p)+y:s.push(y)}),{templateStrings:Object.assign([],i,{raw:s}),valueIndexDeletions:o}}function es(t){return typeof t=="function"&&t.hasOwnProperty("tagName")&&typeof t.tagName=="string"&&t.tagName.includes("-")}const Ko=[Qi("tag name css selector interpolation",(t,e,n)=>es(n),t=>t.tagName)];function zo(t,e){return Zi(t,e,Ko)}function lt(t,...e){const n=Xi(t,e,()=>zo(t,e));return Mi(n.strings,...n.values)}const Lo=[Qi("tag name interpolation",(t,e,n)=>{const r=t.trim().endsWith("<")&&!!e.match(/^[\s\n>]/)||(t==null?void 0:t.trim().endsWith("</"))&&e.trim().startsWith(">"),i=es(n);if(r&&!i)throw console.error({lastNewString:t,currentLitString:e,currentValue:n}),new Error(`Got interpolated tag name but it wasn't of type VirElement: '${n.prototype.constructor.name}'`);return r&&i},t=>t.tagName)];function Ho(t){}function Fo(t){return Zi(t.strings,t.values,Lo,Ho)}function J(t,...e){const n=no(t,...e),r=Xi(t,e,()=>Fo(n));return{...n,strings:r.strings,values:r.values}}function Uo(t,e){return t<e}function jo(t,e){return t>e}function Vo({constraint:t,box:e,constraintType:n="max"}){return(n==="max"?jo:Uo)(e.width/e.height,t.width/t.height)?"width":"height"}function An({box:t,constraint:e,constraintType:n}){const r=Vo({box:t,constraint:e,constraintType:n});return e[r]/t[r]}function ts({box:t,ratio:e}){return Ee(t,(n,r)=>r*e)}function ni({box:t,min:e,max:n}){return Ee(t,(r,i)=>Fs({value:i,min:(e==null?void 0:e[r])??0,max:(n==null?void 0:n[r])??1/0}))}function Wo({min:t,max:e,box:n}){const r=Go({min:t,max:e,box:n}),i=ts({box:n,ratio:r});return{height:i.height||(t==null?void 0:t.height)||250,width:i.width||(t==null?void 0:t.width)||250}}function Go({min:t,max:e,box:n}){if(!t&&!e)return 1;const r=t?An({box:n,constraint:t,constraintType:"min"}):1,i=e?An({box:n,constraint:e,constraintType:"max"}):1,s=r>1?r:i<1?i:1,o=ts({ratio:s,box:n});return(t?An({box:o,constraint:t,constraintType:"min"}):1)>1?r:s}function gt(t){if("templateString"in t)return t.templateString;const{strings:e,values:n}=t;if((!e||!(e!=null&&e.length))&&(!n||!n.length))return"";const r=[...n||[],""],s=(e??[""]).map((o,a)=>{const u=Jo(o,r[a]);return`${o}${u}`});return Pi(s.join(""))}function Jo(t,e){return e._$litType$!=null||e._$litDirective$!=null?gt(e):Array.isArray(e)?e.map(r=>gt(r)).join(""):t.endsWith("=")?`"${e}"`:e}var ri=Object.freeze,Yo=Object.defineProperty,ii=(t,e)=>ri(Yo(t,"raw",{value:ri(e||t.slice())})),si,oi;const Fn="ready-ping",ns="ready-pong",ai=J`
    <div class="click-cover"></div>
`,Vt=Vi()({tagName:"vir-resizable-image",stateInit:{imageData:Fi(),imageDimensions:void 0,shouldVerticallyCenter:!1},hostClasses:{verticallyCenter:({state:t})=>t.shouldVerticallyCenter},styles:({hostClassSelectors:t})=>lt`
        :host {
            position: relative;
            box-sizing: content-box;
            display: flex;
            justify-content: center;
            overflow: hidden;
        }

        ${t.verticallyCenter} {
            align-items: center;
        }

        .click-cover {
            position: absolute;
            height: 100%;
            width: 100%;
            top: 0;
            left: 0;
            z-index: 100;
        }

        * {
            flex-shrink: 0;
        }

        .frame-constraint {
            position: relative;
            transition: 100ms;
        }

        .error-wrapper,
        .loading-wrapper {
            min-width: 100%;
            min-height: 100%;
            max-width: 100%;
            max-height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            word-break: break-word;
        }

        iframe {
            display: block;
            border: none;
            max-width: calc(100% + 1px);
            max-height: calc(100% + 1px);
            width: calc(100% + 1px);
            height: calc(100% + 1px);
        }
    `,renderCallback:({state:t,inputs:e,updateState:n,host:r})=>{n({imageData:{createPromise:async()=>(n({imageDimensions:void 0,shouldVerticallyCenter:!1}),ui(e.imageUrl).catch(async()=>(await Ut(1e3),ui(e.imageUrl)))),trigger:{...ki(e,f=>f!=="extraHTML")}}});const i=e.min&&e.max?ni({box:e.min,max:e.max}):e.min,s=e.max,o=i?lt`
                  min-width: ${i.width}px;
                  min-height: ${i.height}px;
              `:"",a=Hn(t.imageData,J`
                <div class="loading-wrapper" style=${o}>
                    <slot name="loading">Loading...</slot>
                </div>
            `,f=>{const c=r.shadowRoot.querySelector(".frame-constraint");if(!(c instanceof HTMLElement))throw new Error("Could not find frame constraint div.");const h=e.originalImageSize??t.imageDimensions??f.dimensions,m=Wo({min:i,max:s,box:h});c.style.width=ne(Math.floor(m.width)),c.style.height=ne(Math.floor(m.height));const p=ni({min:i,max:s,box:m});return m.height<p.height?n({shouldVerticallyCenter:!0}):n({shouldVerticallyCenter:!1}),r.style.width=ne(p.width),r.style.height=ne(p.height),J`
                    <iframe
                        loading="lazy"
                        referrerpolicy="no-referrer"
                        scrolling="no"
                        srcdoc=${Zo(f,e.extraHTML)}
                        ${Do(async d=>{const y=d;y.onload=async()=>{let b=!1;const S=Date.now();for(;!y.contentWindow;)if(await Ut(100),Date.now()-S>3e4)throw new Error("Took over 10 seconds for the vir-resizable-image iframe's content window to appear.");for(y.contentWindow.addEventListener("message",g=>{if(g.data===Fn)return;if(g.data===ns){b=!0;return}const w=JSON.parse(g.data),v=Number(w.width),_=Number(w.height);!isNaN(v)&&!isNaN(_)?n({imageDimensions:{width:v,height:_}}):console.warn(`Got bad data from vir-resizable-image image iframe: ${JSON.stringify(w)}`)});!b;)y.contentWindow.postMessage(Fn),await Ut(100)}})}
                    ></iframe>
                    <slot name="loaded"></slot>
                `},f=>J`
                    <div class="error-wrapper">
                        <slot name="error">${hn(f)}</slot>
                    </div>
                `),u=Hn(t.imageData,ai,f=>f.imageType==="html"?"":ai,()=>""),l=t.imageData instanceof Error?lt`
                      max-width: 100%;
                      max-height: 100%;
                  `:"";return J`
            <div class="frame-constraint" style=${l}>${a}</div>
            ${u}
        `}});async function qo(t,e){const n=t.headers.get("Content-Type")??"";return n.includes("video")?"video":n.includes("svg")||e.includes("<svg")?"svg":n.includes("html")||e.includes("<html")?"html":"image"}function Qo({imageType:t,imageText:e,imageUrl:n}){return t==="image"?gt(J`
            <img src=${n} />
        `):t==="video"?gt(J`
            <video autoplay muted loop>
                <source src=${n} type="video/mp4" />
            </video>
        `):e}async function ui(t){let e;try{e=await fetch(t)}catch{}const n=await(e==null?void 0:e.text())??"",r=e?await qo(e,n):"image",i=Qo({imageText:n,imageType:r,imageUrl:t}),s=await Xo(t,r);return{templateString:i,dimensions:s,imageUrl:t,imageType:r}}async function Xo(t,e){try{if(e==="video"){const n=await qs(t);return{width:n.videoWidth,height:n.videoHeight}}else{if(e==="html")return{height:0,width:0};{const n=await Ys(t);return{width:n.naturalWidth,height:n.naturalHeight}}}}catch(n){return console.warn(n),{height:0,width:0}}}function Zo(t,e){const n=Math.random(),r=J(si||(si=ii([`
        <script>
            const imageType = '`,`';

            function extractSvgSize(svgElement) {
                const viewBox = svgElement.getAttribute('viewBox');
                const viewBoxDimensions = viewBox?.match(/s*\\d+\\s+\\d+\\s+(\\d+)\\s+(\\d+)\\s*/);
                const viewBoxWidth = Number(viewBoxDimensions?.[1]);
                const viewBoxHeight = Number(viewBoxDimensions?.[2]);
                const width =
                    Number(svgElement.getAttribute('width')?.replace(/px$/, '')) || viewBoxWidth;
                const height =
                    Number(svgElement.getAttribute('height')?.replace(/px$/, '')) || viewBoxHeight;

                if (isNaN(width) || isNaN(height)) {
                    return undefined;
                } else {
                    return {width, height};
                }
            }

            function extractHtmlSize(element = document.body) {
                let size;

                if (element instanceof HTMLImageElement) {
                    size = {
                        width: element.naturalWidth,
                        height: element.naturalHeight,
                    };
                } else {
                    let width = element.getAttribute('width');
                    let height = element.getAttribute('height');
                    if (width && height) {
                        size = {height, width};
                    }
                }

                if (size) {
                    if (!size.height || !size.width) {
                        throw new Error(
                            \`Got invalid html size for '`,`': \${size} \`,
                        );
                    }
                    return size;
                }

                const childSizes = Array.from(element.children).map((child) =>
                    extractHtmlSize(child),
                );

                return childSizes.reduce(
                    (finalSize, currentSize) => {
                        const width = Math.max(finalSize.width, currentSize.width);
                        const height = Math.max(finalSize.height, currentSize.height);
                        return {width, height};
                    },
                    {width: 0, height: 0},
                );
            }

            function postHtmlSize(element = document.body) {
                const size = extractHtmlSize();

                readyPromise.then(() => {
                    globalThis.postMessage(JSON.stringify(size));
                });
            }

            function postSvgSize() {
                const svgElements = Array.from(document.querySelectorAll('svg'));

                if (!svgElements.length) {
                    throw new Error('Failed to find any SVG elements');
                }

                const svgElement = svgElements.find((svgElement) => !!extractSvgSize(svgElement));

                if (!svgElement) {
                    throw new Error('Found no SVG element with dimensions');
                }

                const {height, width} = extractSvgSize(svgElement);

                if (!svgElement.getAttribute('viewBox')) {
                    svgElement.setAttribute('viewBox', \`0 0 \${width} \${height}\`);
                }
                svgElement.removeAttribute('width');
                svgElement.removeAttribute('height');
                svgElement.style.removeProperty('width');
                svgElement.style.removeProperty('height');
                /*
                        console.debug({
                            width, g
                            height,
                            viewBoxWidth,
                            viewBoxHeight,
                            imageUrl: '`,`',
                            dimensions: JSON.parse('`,`'),
                        });
                        */

                readyPromise.then(() => {
                    globalThis.postMessage(JSON.stringify({width, height}));
                });
            }

            function postSize() {
                if (imageType === 'svg') {
                    postSvgSize();
                } else if (imageType === 'html') {
                    postHtmlSize();
                }
            }

            let retryCount = 0;

            function repeatedlyPostSize() {
                try {
                    postSize();
                } catch (error) {
                    retryCount++;
                    if (retryCount > 10) {
                        throw new Error(
                            "Tried to get the '`,"' size for '",`' over 10 times and failed.",
                        );
                    }
                    setTimeout(() => {
                        repeatedlyPostSize();
                    }, 500);
                }
            }

            repeatedlyPostSize();
        <\/script>
    `],[`
        <script>
            const imageType = '`,`';

            function extractSvgSize(svgElement) {
                const viewBox = svgElement.getAttribute('viewBox');
                const viewBoxDimensions = viewBox?.match(/s*\\\\d+\\\\s+\\\\d+\\\\s+(\\\\d+)\\\\s+(\\\\d+)\\\\s*/);
                const viewBoxWidth = Number(viewBoxDimensions?.[1]);
                const viewBoxHeight = Number(viewBoxDimensions?.[2]);
                const width =
                    Number(svgElement.getAttribute('width')?.replace(/px$/, '')) || viewBoxWidth;
                const height =
                    Number(svgElement.getAttribute('height')?.replace(/px$/, '')) || viewBoxHeight;

                if (isNaN(width) || isNaN(height)) {
                    return undefined;
                } else {
                    return {width, height};
                }
            }

            function extractHtmlSize(element = document.body) {
                let size;

                if (element instanceof HTMLImageElement) {
                    size = {
                        width: element.naturalWidth,
                        height: element.naturalHeight,
                    };
                } else {
                    let width = element.getAttribute('width');
                    let height = element.getAttribute('height');
                    if (width && height) {
                        size = {height, width};
                    }
                }

                if (size) {
                    if (!size.height || !size.width) {
                        throw new Error(
                            \\\`Got invalid html size for '`,`': \\\${size} \\\`,
                        );
                    }
                    return size;
                }

                const childSizes = Array.from(element.children).map((child) =>
                    extractHtmlSize(child),
                );

                return childSizes.reduce(
                    (finalSize, currentSize) => {
                        const width = Math.max(finalSize.width, currentSize.width);
                        const height = Math.max(finalSize.height, currentSize.height);
                        return {width, height};
                    },
                    {width: 0, height: 0},
                );
            }

            function postHtmlSize(element = document.body) {
                const size = extractHtmlSize();

                readyPromise.then(() => {
                    globalThis.postMessage(JSON.stringify(size));
                });
            }

            function postSvgSize() {
                const svgElements = Array.from(document.querySelectorAll('svg'));

                if (!svgElements.length) {
                    throw new Error('Failed to find any SVG elements');
                }

                const svgElement = svgElements.find((svgElement) => !!extractSvgSize(svgElement));

                if (!svgElement) {
                    throw new Error('Found no SVG element with dimensions');
                }

                const {height, width} = extractSvgSize(svgElement);

                if (!svgElement.getAttribute('viewBox')) {
                    svgElement.setAttribute('viewBox', \\\`0 0 \\\${width} \\\${height}\\\`);
                }
                svgElement.removeAttribute('width');
                svgElement.removeAttribute('height');
                svgElement.style.removeProperty('width');
                svgElement.style.removeProperty('height');
                /*
                        console.debug({
                            width, g
                            height,
                            viewBoxWidth,
                            viewBoxHeight,
                            imageUrl: '`,`',
                            dimensions: JSON.parse('`,`'),
                        });
                        */

                readyPromise.then(() => {
                    globalThis.postMessage(JSON.stringify({width, height}));
                });
            }

            function postSize() {
                if (imageType === 'svg') {
                    postSvgSize();
                } else if (imageType === 'html') {
                    postHtmlSize();
                }
            }

            let retryCount = 0;

            function repeatedlyPostSize() {
                try {
                    postSize();
                } catch (error) {
                    retryCount++;
                    if (retryCount > 10) {
                        throw new Error(
                            "Tried to get the '`,"' size for '",`' over 10 times and failed.",
                        );
                    }
                    setTimeout(() => {
                        repeatedlyPostSize();
                    }, 500);
                }
            }

            repeatedlyPostSize();
        <\/script>
    `])),t.imageType,t.imageUrl,t.imageUrl,JSON.stringify(t.dimensions),t.imageType,t.imageUrl),i=J(oi||(oi=ii([`
        <!DOCTYPE html>
        <html class="image-type-`,`">
            <head>
                <style>
                    body,
                    html {
                        height: 100vh;
                        width: 100vw;
                        margin: 0;
                        padding: 0;
                        box-sizing: border-box;
                    }

                    img,
                    svg,
                    video {
                        max-height: 100vh;
                        max-width: 100vw;
                        width: 100vw;
                        height: 100vh;
                    }

                    html.image-type-html * {
                        max-height: 100vh;
                        max-width: 100vw;
                    }
                </style>
                <script>
                    let resolve;
                    const readyPromise = new Promise((innerResolve) => {
                        resolve = innerResolve;
                    });
                    globalThis.addEventListener('message', (event) => {
                        if (event.data === '`,`') {
                            resolve();
                            globalThis.postMessage('`,`');
                        }
                    });
                <\/script>
            </head>
            <body>
                `," "," ",`
            </body>
        </html>
    `])),t.imageType.toLowerCase(),Fn,ns,n,r,e??"");return Pi(gt(i)).replace(String(n),`
${t.templateString}
`)}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.
Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.
THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var k=function(){return k=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},k.apply(this,arguments)};function Un(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return t.concat(s||Array.prototype.slice.call(e))}var I=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,z=Object.keys,j=Array.isArray;typeof Promise<"u"&&!I.Promise&&(I.Promise=Promise);function W(t,e){return typeof e!="object"||z(e).forEach(function(n){t[n]=e[n]}),t}var wt=Object.getPrototypeOf,ea={}.hasOwnProperty;function Q(t,e){return ea.call(t,e)}function Qe(t,e){typeof e=="function"&&(e=e(wt(t))),(typeof Reflect>"u"?z:Reflect.ownKeys)(e).forEach(function(n){pe(t,n,e[n])})}var rs=Object.defineProperty;function pe(t,e,n,r){rs(t,e,W(n&&Q(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function Xe(t){return{from:function(e){return t.prototype=Object.create(e.prototype),pe(t.prototype,"constructor",t),{extend:Qe.bind(null,t.prototype)}}}}var ta=Object.getOwnPropertyDescriptor;function br(t,e){var n=ta(t,e),r;return n||(r=wt(t))&&br(r,e)}var na=[].slice;function pn(t,e,n){return na.call(t,e,n)}function is(t,e){return e(t)}function st(t){if(!t)throw new Error("Assertion Failed")}function ss(t){I.setImmediate?setImmediate(t):setTimeout(t,0)}function os(t,e){return t.reduce(function(n,r,i){var s=e(r,i);return s&&(n[s[0]]=s[1]),n},{})}function ra(t,e,n){try{t.apply(null,n)}catch(r){e&&e(r)}}function de(t,e){if(Q(t,e))return t[e];if(!e)return t;if(typeof e!="string"){for(var n=[],r=0,i=e.length;r<i;++r){var s=de(t,e[r]);n.push(s)}return n}var o=e.indexOf(".");if(o!==-1){var a=t[e.substr(0,o)];return a===void 0?void 0:de(a,e.substr(o+1))}}function re(t,e,n){if(!(!t||e===void 0)&&!("isFrozen"in Object&&Object.isFrozen(t)))if(typeof e!="string"&&"length"in e){st(typeof n!="string"&&"length"in n);for(var r=0,i=e.length;r<i;++r)re(t,e[r],n[r])}else{var s=e.indexOf(".");if(s!==-1){var o=e.substr(0,s),a=e.substr(s+1);if(a==="")n===void 0?j(t)&&!isNaN(parseInt(o))?t.splice(o,1):delete t[o]:t[o]=n;else{var u=t[o];(!u||!Q(t,o))&&(u=t[o]={}),re(u,a,n)}}else n===void 0?j(t)&&!isNaN(parseInt(e))?t.splice(e,1):delete t[e]:t[e]=n}}function ia(t,e){typeof e=="string"?re(t,e,void 0):"length"in e&&[].map.call(e,function(n){re(t,n,void 0)})}function as(t){var e={};for(var n in t)Q(t,n)&&(e[n]=t[n]);return e}var sa=[].concat;function us(t){return sa.apply([],t)}var ls="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(us([8,16,32,64].map(function(t){return["Int","Uint","Float"].map(function(e){return e+t+"Array"})}))).filter(function(t){return I[t]}),oa=ls.map(function(t){return I[t]});os(ls,function(t){return[t,!0]});var we=null;function Ct(t){we=typeof WeakMap<"u"&&new WeakMap;var e=jn(t);return we=null,e}function jn(t){if(!t||typeof t!="object")return t;var e=we&&we.get(t);if(e)return e;if(j(t)){e=[],we&&we.set(t,e);for(var n=0,r=t.length;n<r;++n)e.push(jn(t[n]))}else if(oa.indexOf(t.constructor)>=0)e=t;else{var i=wt(t);e=i===Object.prototype?{}:Object.create(i),we&&we.set(t,e);for(var s in t)Q(t,s)&&(e[s]=jn(t[s]))}return e}var aa={}.toString;function Vn(t){return aa.call(t).slice(8,-1)}var Wn=typeof Symbol<"u"?Symbol.iterator:"@@iterator",ua=typeof Wn=="symbol"?function(t){var e;return t!=null&&(e=t[Wn])&&e.apply(t)}:function(){return null},je={};function fe(t){var e,n,r,i;if(arguments.length===1){if(j(t))return t.slice();if(this===je&&typeof t=="string")return[t];if(i=ua(t)){for(n=[];r=i.next(),!r.done;)n.push(r.value);return n}if(t==null)return[t];if(e=t.length,typeof e=="number"){for(n=new Array(e);e--;)n[e]=t[e];return n}return[t]}for(e=arguments.length,n=new Array(e);e--;)n[e]=arguments[e];return n}var _r=typeof Symbol<"u"?function(t){return t[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},ue=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function cs(t,e){ue=t,fs=e}var fs=function(){return!0},la=!new Error("").stack;function ze(){if(la)try{throw ze.arguments,new Error}catch(t){return t}return new Error}function Gn(t,e){var n=t.stack;return n?(e=e||0,n.indexOf(t.name)===0&&(e+=(t.name+t.message).split(`
`).length),n.split(`
`).slice(e).filter(fs).map(function(r){return`
`+r}).join("")):""}var ca=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"],hs=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Sr=ca.concat(hs),fa={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Ze(t,e){this._e=ze(),this.name=t,this.message=e}Xe(Ze).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+Gn(this._e,2))}},toString:function(){return this.name+": "+this.message}});function ds(t,e){return t+". Errors: "+Object.keys(e).map(function(n){return e[n].toString()}).filter(function(n,r,i){return i.indexOf(n)===r}).join(`
`)}function tn(t,e,n,r){this._e=ze(),this.failures=e,this.failedKeys=r,this.successCount=n,this.message=ds(t,e)}Xe(tn).from(Ze);function ct(t,e){this._e=ze(),this.name="BulkError",this.failures=Object.keys(e).map(function(n){return e[n]}),this.failuresByPos=e,this.message=ds(t,e)}Xe(ct).from(Ze);var Er=Sr.reduce(function(t,e){return t[e]=e+"Error",t},{}),ha=Ze,T=Sr.reduce(function(t,e){var n=e+"Error";function r(i,s){this._e=ze(),this.name=n,i?typeof i=="string"?(this.message=""+i+(s?`
 `+s:""),this.inner=s||null):typeof i=="object"&&(this.message=i.name+" "+i.message,this.inner=i):(this.message=fa[e]||n,this.inner=null)}return Xe(r).from(ha),t[e]=r,t},{});T.Syntax=SyntaxError;T.Type=TypeError;T.Range=RangeError;var li=hs.reduce(function(t,e){return t[e+"Error"]=T[e],t},{});function da(t,e){if(!t||t instanceof Ze||t instanceof TypeError||t instanceof SyntaxError||!t.name||!li[t.name])return t;var n=new li[t.name](e||t.message,t);return"stack"in t&&pe(n,"stack",{get:function(){return this.inner.stack}}),n}var vn=Sr.reduce(function(t,e){return["Syntax","Type","Range"].indexOf(e)===-1&&(t[e+"Error"]=T[e]),t},{});vn.ModifyError=tn;vn.DexieError=Ze;vn.BulkError=ct;function N(){}function Tt(t){return t}function pa(t,e){return t==null||t===Tt?e:function(n){return e(t(n))}}function Ie(t,e){return function(){t.apply(this,arguments),e.apply(this,arguments)}}function va(t,e){return t===N?e:function(){var n=t.apply(this,arguments);n!==void 0&&(arguments[0]=n);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var s=e.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?Ie(r,this.onsuccess):r),i&&(this.onerror=this.onerror?Ie(i,this.onerror):i),s!==void 0?s:n}}function ma(t,e){return t===N?e:function(){t.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,e.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?Ie(n,this.onsuccess):n),r&&(this.onerror=this.onerror?Ie(r,this.onerror):r)}}function ya(t,e){return t===N?e:function(n){var r=t.apply(this,arguments);W(n,r);var i=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var o=e.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?Ie(i,this.onsuccess):i),s&&(this.onerror=this.onerror?Ie(s,this.onerror):s),r===void 0?o===void 0?void 0:o:W(r,o)}}function ga(t,e){return t===N?e:function(){return e.apply(this,arguments)===!1?!1:t.apply(this,arguments)}}function xr(t,e){return t===N?e:function(){var n=t.apply(this,arguments);if(n&&typeof n.then=="function"){for(var r=this,i=arguments.length,s=new Array(i);i--;)s[i]=arguments[i];return n.then(function(){return e.apply(r,s)})}return e.apply(this,arguments)}}var bt={},wa=100,ba=20,ps=100,Ar=typeof Promise>"u"?[]:function(){var t=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[t,wt(t),t];var e=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[e,wt(e),t]}(),Jn=Ar[0],nn=Ar[1],Yn=Ar[2],vs=nn&&nn.then,Wt=Jn&&Jn.constructor,$r=!!Yn,qn=!1,_a=Yn?function(){Yn.then(Nt)}:I.setImmediate?setImmediate.bind(null,Nt):I.MutationObserver?function(){var t=document.createElement("div");new MutationObserver(function(){Nt(),t=null}).observe(t,{attributes:!0}),t.setAttribute("i","1")}:function(){setTimeout(Nt,0)},_t=function(t,e){ot.push([t,e]),rn&&(_a(),rn=!1)},Qn=!0,rn=!0,Me=[],Gt=[],Xn=null,Zn=Tt,Ge={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:hi,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(function(t){try{hi(t[0],t[1])}catch{}})}},A=Ge,ot=[],Be=0,Jt=[];function x(t){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=N,this._lib=!1;var e=this._PSD=A;if(ue&&(this._stackHolder=ze(),this._prev=null,this._numPrev=0),typeof t!="function"){if(t!==bt)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&tr(this,this._value);return}this._state=null,this._value=null,++e.ref,ys(this,t)}var er={get:function(){var t=A,e=sn;function n(r,i){var s=this,o=!t.global&&(t!==A||e!==sn),a=o&&!ve(),u=new x(function(l,f){Cr(s,new ms(an(r,t,o,a),an(i,t,o,a),l,f,t))});return ue&&bs(u,this),u}return n.prototype=bt,n},set:function(t){pe(this,"then",t&&t.prototype===bt?er:{get:function(){return t},set:er.set})}};Qe(x.prototype,{then:er,_then:function(t,e){Cr(this,new ms(null,null,t,e,A))},catch:function(t){if(arguments.length===1)return this.then(null,t);var e=arguments[0],n=arguments[1];return typeof e=="function"?this.then(null,function(r){return r instanceof e?n(r):Yt(r)}):this.then(null,function(r){return r&&r.name===e?n(r):Yt(r)})},finally:function(t){return this.then(function(e){return t(),e},function(e){return t(),Yt(e)})},stack:{get:function(){if(this._stack)return this._stack;try{qn=!0;var t=ws(this,[],ba),e=t.join(`
From previous: `);return this._state!==null&&(this._stack=e),e}finally{qn=!1}}},timeout:function(t,e){var n=this;return t<1/0?new x(function(r,i){var s=setTimeout(function(){return i(new T.Timeout(e))},t);n.then(r,i).finally(clearTimeout.bind(null,s))}):this}});typeof Symbol<"u"&&Symbol.toStringTag&&pe(x.prototype,Symbol.toStringTag,"Dexie.Promise");Ge.env=_s();function ms(t,e,n,r,i){this.onFulfilled=typeof t=="function"?t:null,this.onRejected=typeof e=="function"?e:null,this.resolve=n,this.reject=r,this.psd=i}Qe(x,{all:function(){var t=fe.apply(null,arguments).map(on);return new x(function(e,n){t.length===0&&e([]);var r=t.length;t.forEach(function(i,s){return x.resolve(i).then(function(o){t[s]=o,--r||e(t)},n)})})},resolve:function(t){if(t instanceof x)return t;if(t&&typeof t.then=="function")return new x(function(n,r){t.then(n,r)});var e=new x(bt,!0,t);return bs(e,Xn),e},reject:Yt,race:function(){var t=fe.apply(null,arguments).map(on);return new x(function(e,n){t.map(function(r){return x.resolve(r).then(e,n)})})},PSD:{get:function(){return A},set:function(t){return A=t}},totalEchoes:{get:function(){return sn}},newPSD:Ae,usePSD:tt,scheduler:{get:function(){return _t},set:function(t){_t=t}},rejectionMapper:{get:function(){return Zn},set:function(t){Zn=t}},follow:function(t,e){return new x(function(n,r){return Ae(function(i,s){var o=A;o.unhandleds=[],o.onunhandled=s,o.finalize=Ie(function(){var a=this;Ea(function(){a.unhandleds.length===0?i():s(a.unhandleds[0])})},o.finalize),t()},e,n,r)})}});Wt&&(Wt.allSettled&&pe(x,"allSettled",function(){var t=fe.apply(null,arguments).map(on);return new x(function(e){t.length===0&&e([]);var n=t.length,r=new Array(n);t.forEach(function(i,s){return x.resolve(i).then(function(o){return r[s]={status:"fulfilled",value:o}},function(o){return r[s]={status:"rejected",reason:o}}).then(function(){return--n||e(r)})})})}),Wt.any&&typeof AggregateError<"u"&&pe(x,"any",function(){var t=fe.apply(null,arguments).map(on);return new x(function(e,n){t.length===0&&n(new AggregateError([]));var r=t.length,i=new Array(r);t.forEach(function(s,o){return x.resolve(s).then(function(a){return e(a)},function(a){i[o]=a,--r||n(new AggregateError(i))})})})}));function ys(t,e){try{e(function(n){if(t._state===null){if(n===t)throw new TypeError("A promise cannot be resolved with itself.");var r=t._lib&&Pt();n&&typeof n.then=="function"?ys(t,function(i,s){n instanceof x?n._then(i,s):n.then(i,s)}):(t._state=!0,t._value=n,gs(t)),r&&Rt()}},tr.bind(null,t))}catch(n){tr(t,n)}}function tr(t,e){if(Gt.push(e),t._state===null){var n=t._lib&&Pt();e=Zn(e),t._state=!1,t._value=e,ue&&e!==null&&typeof e=="object"&&!e._promise&&ra(function(){var r=br(e,"stack");e._promise=t,pe(e,"stack",{get:function(){return qn?r&&(r.get?r.get.apply(e):r.value):t.stack}})}),xa(t),gs(t),n&&Rt()}}function gs(t){var e=t._listeners;t._listeners=[];for(var n=0,r=e.length;n<r;++n)Cr(t,e[n]);var i=t._PSD;--i.ref||i.finalize(),Be===0&&(++Be,_t(function(){--Be===0&&Tr()},[]))}function Cr(t,e){if(t._state===null){t._listeners.push(e);return}var n=t._state?e.onFulfilled:e.onRejected;if(n===null)return(t._state?e.resolve:e.reject)(t._value);++e.psd.ref,++Be,_t(Sa,[n,t,e])}function Sa(t,e,n){try{Xn=e;var r,i=e._value;e._state?r=t(i):(Gt.length&&(Gt=[]),r=t(i),Gt.indexOf(i)===-1&&Aa(e)),n.resolve(r)}catch(s){n.reject(s)}finally{Xn=null,--Be===0&&Tr(),--n.psd.ref||n.psd.finalize()}}function ws(t,e,n){if(e.length===n)return e;var r="";if(t._state===!1){var i=t._value,s,o;i!=null?(s=i.name||"Error",o=i.message||i,r=Gn(i,0)):(s=i,o=""),e.push(s+(o?": "+o:"")+r)}return ue&&(r=Gn(t._stackHolder,2),r&&e.indexOf(r)===-1&&e.push(r),t._prev&&ws(t._prev,e,n)),e}function bs(t,e){var n=e?e._numPrev+1:0;n<wa&&(t._prev=e,t._numPrev=n)}function Nt(){Pt()&&Rt()}function Pt(){var t=Qn;return Qn=!1,rn=!1,t}function Rt(){var t,e,n;do for(;ot.length>0;)for(t=ot,ot=[],n=t.length,e=0;e<n;++e){var r=t[e];r[0].apply(null,r[1])}while(ot.length>0);Qn=!0,rn=!0}function Tr(){var t=Me;Me=[],t.forEach(function(r){r._PSD.onunhandled.call(null,r._value,r)});for(var e=Jt.slice(0),n=e.length;n;)e[--n]()}function Ea(t){function e(){t(),Jt.splice(Jt.indexOf(e),1)}Jt.push(e),++Be,_t(function(){--Be===0&&Tr()},[])}function xa(t){Me.some(function(e){return e._value===t._value})||Me.push(t)}function Aa(t){for(var e=Me.length;e;)if(Me[--e]._value===t._value){Me.splice(e,1);return}}function Yt(t){return new x(bt,!1,t)}function K(t,e){var n=A;return function(){var r=Pt(),i=A;try{return $e(n,!0),t.apply(this,arguments)}catch(s){e&&e(s)}finally{$e(i,!1),r&&Rt()}}}var U={awaits:0,echoes:0,id:0},$a=0,qt=[],$n=0,sn=0,Ca=0;function Ae(t,e,n,r){var i=A,s=Object.create(i);s.parent=i,s.ref=0,s.global=!1,s.id=++Ca;var o=Ge.env;s.env=$r?{Promise:x,PromiseProp:{value:x,configurable:!0,writable:!0},all:x.all,race:x.race,allSettled:x.allSettled,any:x.any,resolve:x.resolve,reject:x.reject,nthen:ci(o.nthen,s),gthen:ci(o.gthen,s)}:{},e&&W(s,e),++i.ref,s.finalize=function(){--this.parent.ref||this.parent.finalize()};var a=tt(s,t,n,r);return s.ref===0&&s.finalize(),a}function et(){return U.id||(U.id=++$a),++U.awaits,U.echoes+=ps,U.id}function ve(){return U.awaits?(--U.awaits===0&&(U.id=0),U.echoes=U.awaits*ps,!0):!1}(""+vs).indexOf("[native code]")===-1&&(et=ve=N);function on(t){return U.echoes&&t&&t.constructor===Wt?(et(),t.then(function(e){return ve(),e},function(e){return ve(),L(e)})):t}function Ta(t){++sn,(!U.echoes||--U.echoes===0)&&(U.echoes=U.id=0),qt.push(A),$e(t,!0)}function Pa(){var t=qt[qt.length-1];qt.pop(),$e(t,!1)}function $e(t,e){var n=A;if((e?U.echoes&&(!$n++||t!==A):$n&&(!--$n||t!==A))&&Ss(e?Ta.bind(null,t):Pa),t!==A&&(A=t,n===Ge&&(Ge.env=_s()),$r)){var r=Ge.env.Promise,i=t.env;nn.then=i.nthen,r.prototype.then=i.gthen,(n.global||t.global)&&(Object.defineProperty(I,"Promise",i.PromiseProp),r.all=i.all,r.race=i.race,r.resolve=i.resolve,r.reject=i.reject,i.allSettled&&(r.allSettled=i.allSettled),i.any&&(r.any=i.any))}}function _s(){var t=I.Promise;return $r?{Promise:t,PromiseProp:Object.getOwnPropertyDescriptor(I,"Promise"),all:t.all,race:t.race,allSettled:t.allSettled,any:t.any,resolve:t.resolve,reject:t.reject,nthen:nn.then,gthen:t.prototype.then}:{}}function tt(t,e,n,r,i){var s=A;try{return $e(t,!0),e(n,r,i)}finally{$e(s,!1)}}function Ss(t){vs.call(Jn,t)}function an(t,e,n,r){return typeof t!="function"?t:function(){var i=A;n&&et(),$e(e,!0);try{return t.apply(this,arguments)}finally{$e(i,!1),r&&Ss(ve)}}}function ci(t,e){return function(n,r){return t.call(this,an(n,e),an(r,e))}}var fi="unhandledrejection";function hi(t,e){var n;try{n=e.onuncatched(t)}catch{}if(n!==!1)try{var r,i={promise:e,reason:t};if(I.document&&document.createEvent?(r=document.createEvent("Event"),r.initEvent(fi,!0,!0),W(r,i)):I.CustomEvent&&(r=new CustomEvent(fi,{detail:i}),W(r,i)),r&&I.dispatchEvent&&(dispatchEvent(r),!I.PromiseRejectionEvent&&I.onunhandledrejection))try{I.onunhandledrejection(r)}catch{}ue&&r&&!r.defaultPrevented&&console.warn("Unhandled rejection: "+(t.stack||t))}catch{}}var L=x.reject;function nr(t,e,n,r){if(!t.idbdb||!t._state.openComplete&&!A.letThrough&&!t._vip){if(t._state.openComplete)return L(new T.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._options.autoOpen)return L(new T.DatabaseClosed);t.open().catch(N)}return t._state.dbReadyPromise.then(function(){return nr(t,e,n,r)})}else{var i=t._createTransaction(e,n,t._dbSchema);try{i.create(),t._state.PR1398_maxLoop=3}catch(s){return s.name===Er.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(function(){return nr(t,e,n,r)})):L(s)}return i._promise(e,function(s,o){return Ae(function(){return A.trans=i,r(s,o,i)})}).then(function(s){return i._completion.then(function(){return s})})}}var di="3.2.3",Oe=String.fromCharCode(65535),rr=-1/0,le="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Es="String expected.",ft=[],mn=typeof navigator<"u"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),Ra=mn,ka=mn,xs=function(t){return!/(dexie\.js|dexie\.min\.js)/.test(t)},yn="__dbnames",Cn="readonly",Tn="readwrite";function Ke(t,e){return t?e?function(){return t.apply(this,arguments)&&e.apply(this,arguments)}:t:e}var As={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function It(t){return typeof t=="string"&&!/\./.test(t)?function(e){return e[t]===void 0&&t in e&&(e=Ct(e),delete e[t]),e}:function(e){return e}}var Da=function(){function t(){}return t.prototype._trans=function(e,n,r){var i=this._tx||A.trans,s=this.name;function o(u,l,f){if(!f.schema[s])throw new T.NotFound("Table "+s+" not part of transaction");return n(f.idbtrans,f)}var a=Pt();try{return i&&i.db===this.db?i===A.trans?i._promise(e,o,r):Ae(function(){return i._promise(e,o,r)},{trans:i,transless:A.transless||A}):nr(this.db,e,[this.name],o)}finally{a&&Rt()}},t.prototype.get=function(e,n){var r=this;return e&&e.constructor===Object?this.where(e).first(n):this._trans("readonly",function(i){return r.core.get({trans:i,key:e}).then(function(s){return r.hook.reading.fire(s)})}).then(n)},t.prototype.where=function(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(j(e))return new this.db.WhereClause(this,"["+e.join("+")+"]");var n=z(e);if(n.length===1)return this.where(n[0]).equals(e[n[0]]);var r=this.schema.indexes.concat(this.schema.primKey).filter(function(f){return f.compound&&n.every(function(c){return f.keyPath.indexOf(c)>=0})&&f.keyPath.every(function(c){return n.indexOf(c)>=0})})[0];if(r&&this.db._maxKey!==Oe)return this.where(r.name).equals(r.keyPath.map(function(f){return e[f]}));!r&&ue&&console.warn("The query "+JSON.stringify(e)+" on "+this.name+" would benefit of a "+("compound index ["+n.join("+")+"]"));var i=this.schema.idxByName,s=this.db._deps.indexedDB;function o(f,c){try{return s.cmp(f,c)===0}catch{return!1}}var a=n.reduce(function(f,c){var h=f[0],m=f[1],p=i[c],d=e[c];return[h||p,h||!p?Ke(m,p&&p.multi?function(y){var b=de(y,c);return j(b)&&b.some(function(S){return o(d,S)})}:function(y){return o(d,de(y,c))}):m]},[null,null]),u=a[0],l=a[1];return u?this.where(u.name).equals(e[u.keyPath]).filter(l):r?this.filter(l):this.where(n).equals("")},t.prototype.filter=function(e){return this.toCollection().and(e)},t.prototype.count=function(e){return this.toCollection().count(e)},t.prototype.offset=function(e){return this.toCollection().offset(e)},t.prototype.limit=function(e){return this.toCollection().limit(e)},t.prototype.each=function(e){return this.toCollection().each(e)},t.prototype.toArray=function(e){return this.toCollection().toArray(e)},t.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},t.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,j(e)?"["+e.join("+")+"]":e))},t.prototype.reverse=function(){return this.toCollection().reverse()},t.prototype.mapToClass=function(e){this.schema.mappedClass=e;var n=function(r){if(!r)return r;var i=Object.create(e.prototype);for(var s in r)if(Q(r,s))try{i[s]=r[s]}catch{}return i};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=n,this.hook("reading",n),e},t.prototype.defineClass=function(){function e(n){W(this,n)}return this.mapToClass(e)},t.prototype.add=function(e,n){var r=this,i=this.schema.primKey,s=i.auto,o=i.keyPath,a=e;return o&&s&&(a=It(o)(e)),this._trans("readwrite",function(u){return r.core.mutate({trans:u,type:"add",keys:n!=null?[n]:null,values:[a]})}).then(function(u){return u.numFailures?x.reject(u.failures[0]):u.lastResult}).then(function(u){if(o)try{re(e,o,u)}catch{}return u})},t.prototype.update=function(e,n){if(typeof e=="object"&&!j(e)){var r=de(e,this.schema.primKey.keyPath);if(r===void 0)return L(new T.InvalidArgument("Given object does not contain its primary key"));try{typeof n!="function"?z(n).forEach(function(i){re(e,i,n[i])}):n(e,{value:e,primKey:r})}catch{}return this.where(":id").equals(r).modify(n)}else return this.where(":id").equals(e).modify(n)},t.prototype.put=function(e,n){var r=this,i=this.schema.primKey,s=i.auto,o=i.keyPath,a=e;return o&&s&&(a=It(o)(e)),this._trans("readwrite",function(u){return r.core.mutate({trans:u,type:"put",values:[a],keys:n!=null?[n]:null})}).then(function(u){return u.numFailures?x.reject(u.failures[0]):u.lastResult}).then(function(u){if(o)try{re(e,o,u)}catch{}return u})},t.prototype.delete=function(e){var n=this;return this._trans("readwrite",function(r){return n.core.mutate({trans:r,type:"delete",keys:[e]})}).then(function(r){return r.numFailures?x.reject(r.failures[0]):void 0})},t.prototype.clear=function(){var e=this;return this._trans("readwrite",function(n){return e.core.mutate({trans:n,type:"deleteRange",range:As})}).then(function(n){return n.numFailures?x.reject(n.failures[0]):void 0})},t.prototype.bulkGet=function(e){var n=this;return this._trans("readonly",function(r){return n.core.getMany({keys:e,trans:r}).then(function(i){return i.map(function(s){return n.hook.reading.fire(s)})})})},t.prototype.bulkAdd=function(e,n,r){var i=this,s=Array.isArray(n)?n:void 0;r=r||(s?void 0:n);var o=r?r.allKeys:void 0;return this._trans("readwrite",function(a){var u=i.schema.primKey,l=u.auto,f=u.keyPath;if(f&&s)throw new T.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(s&&s.length!==e.length)throw new T.InvalidArgument("Arguments objects and keys must have the same length");var c=e.length,h=f&&l?e.map(It(f)):e;return i.core.mutate({trans:a,type:"add",keys:s,values:h,wantResults:o}).then(function(m){var p=m.numFailures,d=m.results,y=m.lastResult,b=m.failures,S=o?d:y;if(p===0)return S;throw new ct(i.name+".bulkAdd(): "+p+" of "+c+" operations failed",b)})})},t.prototype.bulkPut=function(e,n,r){var i=this,s=Array.isArray(n)?n:void 0;r=r||(s?void 0:n);var o=r?r.allKeys:void 0;return this._trans("readwrite",function(a){var u=i.schema.primKey,l=u.auto,f=u.keyPath;if(f&&s)throw new T.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(s&&s.length!==e.length)throw new T.InvalidArgument("Arguments objects and keys must have the same length");var c=e.length,h=f&&l?e.map(It(f)):e;return i.core.mutate({trans:a,type:"put",keys:s,values:h,wantResults:o}).then(function(m){var p=m.numFailures,d=m.results,y=m.lastResult,b=m.failures,S=o?d:y;if(p===0)return S;throw new ct(i.name+".bulkPut(): "+p+" of "+c+" operations failed",b)})})},t.prototype.bulkDelete=function(e){var n=this,r=e.length;return this._trans("readwrite",function(i){return n.core.mutate({trans:i,type:"delete",keys:e})}).then(function(i){var s=i.numFailures,o=i.lastResult,a=i.failures;if(s===0)return o;throw new ct(n.name+".bulkDelete(): "+s+" of "+r+" operations failed",a)})},t}();function kt(t){var e={},n=function(a,u){if(u){for(var l=arguments.length,f=new Array(l-1);--l;)f[l-1]=arguments[l];return e[a].subscribe.apply(null,f),t}else if(typeof a=="string")return e[a]};n.addEventType=s;for(var r=1,i=arguments.length;r<i;++r)s(arguments[r]);return n;function s(a,u,l){if(typeof a=="object")return o(a);u||(u=ga),l||(l=N);var f={subscribers:[],fire:l,subscribe:function(c){f.subscribers.indexOf(c)===-1&&(f.subscribers.push(c),f.fire=u(f.fire,c))},unsubscribe:function(c){f.subscribers=f.subscribers.filter(function(h){return h!==c}),f.fire=f.subscribers.reduce(u,l)}};return e[a]=n[a]=f,f}function o(a){z(a).forEach(function(u){var l=a[u];if(j(l))s(u,a[u][0],a[u][1]);else if(l==="asap")var f=s(u,Tt,function(){for(var h=arguments.length,m=new Array(h);h--;)m[h]=arguments[h];f.subscribers.forEach(function(p){ss(function(){p.apply(null,m)})})});else throw new T.InvalidArgument("Invalid event config")})}}function Dt(t,e){return Xe(e).from({prototype:t}),e}function Oa(t){return Dt(Da.prototype,function(n,r,i){this.db=t,this._tx=i,this.name=n,this.schema=r,this.hook=t._allTables[n]?t._allTables[n].hook:kt(null,{creating:[va,N],reading:[pa,Tt],updating:[ya,N],deleting:[ma,N]})})}function Le(t,e){return!(t.filter||t.algorithm||t.or)&&(e?t.justLimit:!t.replayFilter)}function Pn(t,e){t.filter=Ke(t.filter,e)}function Rn(t,e,n){var r=t.replayFilter;t.replayFilter=r?function(){return Ke(r(),e())}:e,t.justLimit=n&&!r}function Ma(t,e){t.isMatch=Ke(t.isMatch,e)}function Qt(t,e){if(t.isPrimKey)return e.primaryKey;var n=e.getIndexByKeyPath(t.index);if(!n)throw new T.Schema("KeyPath "+t.index+" on object store "+e.name+" is not indexed");return n}function pi(t,e,n){var r=Qt(t,e.schema);return e.openCursor({trans:n,values:!t.keysOnly,reverse:t.dir==="prev",unique:!!t.unique,query:{index:r,range:t.range}})}function Kt(t,e,n,r){var i=t.replayFilter?Ke(t.filter,t.replayFilter()):t.filter;if(t.or){var s={},o=function(a,u,l){if(!i||i(u,l,function(h){return u.stop(h)},function(h){return u.fail(h)})){var f=u.primaryKey,c=""+f;c==="[object ArrayBuffer]"&&(c=""+new Uint8Array(f)),Q(s,c)||(s[c]=!0,e(a,u,l))}};return Promise.all([t.or._iterate(o,n),vi(pi(t,r,n),t.algorithm,o,!t.keysOnly&&t.valueMapper)])}else return vi(pi(t,r,n),Ke(t.algorithm,i),e,!t.keysOnly&&t.valueMapper)}function vi(t,e,n,r){var i=r?function(o,a,u){return n(r(o),a,u)}:n,s=K(i);return t.then(function(o){if(o)return o.start(function(){var a=function(){return o.continue()};(!e||e(o,function(u){return a=u},function(u){o.stop(u),a=N},function(u){o.fail(u),a=N}))&&s(o.value,o,function(u){return a=u}),a()})})}function V(t,e){try{var n=mi(t),r=mi(e);if(n!==r)return n==="Array"?1:r==="Array"?-1:n==="binary"?1:r==="binary"?-1:n==="string"?1:r==="string"?-1:n==="Date"?1:r!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return t>e?1:t<e?-1:0;case"binary":return Na(yi(t),yi(e));case"Array":return Ba(t,e)}}catch{}return NaN}function Ba(t,e){for(var n=t.length,r=e.length,i=n<r?n:r,s=0;s<i;++s){var o=V(t[s],e[s]);if(o!==0)return o}return n===r?0:n<r?-1:1}function Na(t,e){for(var n=t.length,r=e.length,i=n<r?n:r,s=0;s<i;++s)if(t[s]!==e[s])return t[s]<e[s]?-1:1;return n===r?0:n<r?-1:1}function mi(t){var e=typeof t;if(e!=="object")return e;if(ArrayBuffer.isView(t))return"binary";var n=Vn(t);return n==="ArrayBuffer"?"binary":n}function yi(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):new Uint8Array(t)}var Ia=function(){function t(){}return t.prototype._read=function(e,n){var r=this._ctx;return r.error?r.table._trans(null,L.bind(null,r.error)):r.table._trans("readonly",e).then(n)},t.prototype._write=function(e){var n=this._ctx;return n.error?n.table._trans(null,L.bind(null,n.error)):n.table._trans("readwrite",e,"locked")},t.prototype._addAlgorithm=function(e){var n=this._ctx;n.algorithm=Ke(n.algorithm,e)},t.prototype._iterate=function(e,n){return Kt(this._ctx,e,n,this._ctx.table.core)},t.prototype.clone=function(e){var n=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return e&&W(r,e),n._ctx=r,n},t.prototype.raw=function(){return this._ctx.valueMapper=null,this},t.prototype.each=function(e){var n=this._ctx;return this._read(function(r){return Kt(n,e,r,n.table.core)})},t.prototype.count=function(e){var n=this;return this._read(function(r){var i=n._ctx,s=i.table.core;if(Le(i,!0))return s.count({trans:r,query:{index:Qt(i,s.schema),range:i.range}}).then(function(a){return Math.min(a,i.limit)});var o=0;return Kt(i,function(){return++o,!1},r,s).then(function(){return o})}).then(e)},t.prototype.sortBy=function(e,n){var r=e.split(".").reverse(),i=r[0],s=r.length-1;function o(l,f){return f?o(l[r[f]],f-1):l[i]}var a=this._ctx.dir==="next"?1:-1;function u(l,f){var c=o(l,s),h=o(f,s);return c<h?-a:c>h?a:0}return this.toArray(function(l){return l.sort(u)}).then(n)},t.prototype.toArray=function(e){var n=this;return this._read(function(r){var i=n._ctx;if(i.dir==="next"&&Le(i,!0)&&i.limit>0){var s=i.valueMapper,o=Qt(i,i.table.core.schema);return i.table.core.query({trans:r,limit:i.limit,values:!0,query:{index:o,range:i.range}}).then(function(u){var l=u.result;return s?l.map(s):l})}else{var a=[];return Kt(i,function(u){return a.push(u)},r,i.table.core).then(function(){return a})}},e)},t.prototype.offset=function(e){var n=this._ctx;return e<=0?this:(n.offset+=e,Le(n)?Rn(n,function(){var r=e;return function(i,s){return r===0?!0:r===1?(--r,!1):(s(function(){i.advance(r),r=0}),!1)}}):Rn(n,function(){var r=e;return function(){return--r<0}}),this)},t.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),Rn(this._ctx,function(){var n=e;return function(r,i,s){return--n<=0&&i(s),n>=0}},!0),this},t.prototype.until=function(e,n){return Pn(this._ctx,function(r,i,s){return e(r.value)?(i(s),n):!0}),this},t.prototype.first=function(e){return this.limit(1).toArray(function(n){return n[0]}).then(e)},t.prototype.last=function(e){return this.reverse().first(e)},t.prototype.filter=function(e){return Pn(this._ctx,function(n){return e(n.value)}),Ma(this._ctx,e),this},t.prototype.and=function(e){return this.filter(e)},t.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},t.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},t.prototype.desc=function(){return this.reverse()},t.prototype.eachKey=function(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,i){e(i.key,i)})},t.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},t.prototype.eachPrimaryKey=function(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,i){e(i.primaryKey,i)})},t.prototype.keys=function(e){var n=this._ctx;n.keysOnly=!n.isMatch;var r=[];return this.each(function(i,s){r.push(s.key)}).then(function(){return r}).then(e)},t.prototype.primaryKeys=function(e){var n=this._ctx;if(n.dir==="next"&&Le(n,!0)&&n.limit>0)return this._read(function(i){var s=Qt(n,n.table.core.schema);return n.table.core.query({trans:i,values:!1,limit:n.limit,query:{index:s,range:n.range}})}).then(function(i){var s=i.result;return s}).then(e);n.keysOnly=!n.isMatch;var r=[];return this.each(function(i,s){r.push(s.primaryKey)}).then(function(){return r}).then(e)},t.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},t.prototype.firstKey=function(e){return this.limit(1).keys(function(n){return n[0]}).then(e)},t.prototype.lastKey=function(e){return this.reverse().firstKey(e)},t.prototype.distinct=function(){var e=this._ctx,n=e.index&&e.table.schema.idxByName[e.index];if(!n||!n.multi)return this;var r={};return Pn(this._ctx,function(i){var s=i.primaryKey.toString(),o=Q(r,s);return r[s]=!0,!o}),this},t.prototype.modify=function(e){var n=this,r=this._ctx;return this._write(function(i){var s;if(typeof e=="function")s=e;else{var o=z(e),a=o.length;s=function(b){for(var S=!1,g=0;g<a;++g){var w=o[g],v=e[w];de(b,w)!==v&&(re(b,w,v),S=!0)}return S}}var u=r.table.core,l=u.schema.primaryKey,f=l.outbound,c=l.extractKey,h=n.db._options.modifyChunkSize||200,m=[],p=0,d=[],y=function(b,S){var g=S.failures,w=S.numFailures;p+=b-w;for(var v=0,_=z(g);v<_.length;v++){var $=_[v];m.push(g[$])}};return n.clone().primaryKeys().then(function(b){var S=function(g){var w=Math.min(h,b.length-g);return u.getMany({trans:i,keys:b.slice(g,g+w),cache:"immutable"}).then(function(v){for(var _=[],$=[],E=f?[]:null,C=[],P=0;P<w;++P){var M=v[P],B={value:Ct(M),primKey:b[g+P]};s.call(B,B.value,B)!==!1&&(B.value==null?C.push(b[g+P]):!f&&V(c(M),c(B.value))!==0?(C.push(b[g+P]),_.push(B.value)):($.push(B.value),f&&E.push(b[g+P])))}var D=Le(r)&&r.limit===1/0&&(typeof e!="function"||e===kn)&&{index:r.index,range:r.range};return Promise.resolve(_.length>0&&u.mutate({trans:i,type:"add",values:_}).then(function(F){for(var R in F.failures)C.splice(parseInt(R),1);y(_.length,F)})).then(function(){return($.length>0||D&&typeof e=="object")&&u.mutate({trans:i,type:"put",keys:E,values:$,criteria:D,changeSpec:typeof e!="function"&&e}).then(function(F){return y($.length,F)})}).then(function(){return(C.length>0||D&&e===kn)&&u.mutate({trans:i,type:"delete",keys:C,criteria:D}).then(function(F){return y(C.length,F)})}).then(function(){return b.length>g+w&&S(g+h)})})};return S(0).then(function(){if(m.length>0)throw new tn("Error modifying one or more objects",m,p,d);return b.length})})})},t.prototype.delete=function(){var e=this._ctx,n=e.range;return Le(e)&&(e.isPrimKey&&!ka||n.type===3)?this._write(function(r){var i=e.table.core.schema.primaryKey,s=n;return e.table.core.count({trans:r,query:{index:i,range:s}}).then(function(o){return e.table.core.mutate({trans:r,type:"deleteRange",range:s}).then(function(a){var u=a.failures;a.lastResult,a.results;var l=a.numFailures;if(l)throw new tn("Could not delete some values",Object.keys(u).map(function(f){return u[f]}),o-l);return o-l})})}):this.modify(kn)},t}(),kn=function(t,e){return e.value=null};function Ka(t){return Dt(Ia.prototype,function(n,r){this.db=t;var i=As,s=null;if(r)try{i=r()}catch(l){s=l}var o=n._ctx,a=o.table,u=a.hook.reading.fire;this._ctx={table:a,index:o.index,isPrimKey:!o.index||a.schema.primKey.keyPath&&o.index===a.schema.primKey.name,range:i,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:s,or:o.or,valueMapper:u!==Tt?u:null}})}function za(t,e){return t<e?-1:t===e?0:1}function La(t,e){return t>e?-1:t===e?0:1}function Y(t,e,n){var r=t instanceof Cs?new t.Collection(t):t;return r._ctx.error=n?new n(e):new TypeError(e),r}function He(t){return new t.Collection(t,function(){return $s("")}).limit(0)}function Ha(t){return t==="next"?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()}}function Fa(t){return t==="next"?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()}}function Ua(t,e,n,r,i,s){for(var o=Math.min(t.length,r.length),a=-1,u=0;u<o;++u){var l=e[u];if(l!==r[u])return i(t[u],n[u])<0?t.substr(0,u)+n[u]+n.substr(u+1):i(t[u],r[u])<0?t.substr(0,u)+r[u]+n.substr(u+1):a>=0?t.substr(0,a)+e[a]+n.substr(a+1):null;i(t[u],l)<0&&(a=u)}return o<r.length&&s==="next"?t+n.substr(t.length):o<t.length&&s==="prev"?t.substr(0,n.length):a<0?null:t.substr(0,a)+r[a]+n.substr(a+1)}function zt(t,e,n,r){var i,s,o,a,u,l,f,c=n.length;if(!n.every(function(d){return typeof d=="string"}))return Y(t,Es);function h(d){i=Ha(d),s=Fa(d),o=d==="next"?za:La;var y=n.map(function(b){return{lower:s(b),upper:i(b)}}).sort(function(b,S){return o(b.lower,S.lower)});a=y.map(function(b){return b.upper}),u=y.map(function(b){return b.lower}),l=d,f=d==="next"?"":r}h("next");var m=new t.Collection(t,function(){return ge(a[0],u[c-1]+r)});m._ondirectionchange=function(d){h(d)};var p=0;return m._addAlgorithm(function(d,y,b){var S=d.key;if(typeof S!="string")return!1;var g=s(S);if(e(g,u,p))return!0;for(var w=null,v=p;v<c;++v){var _=Ua(S,g,a[v],u[v],o,l);_===null&&w===null?p=v+1:(w===null||o(w,_)>0)&&(w=_)}return y(w!==null?function(){d.continue(w+f)}:b),!1}),m}function ge(t,e,n,r){return{type:2,lower:t,upper:e,lowerOpen:n,upperOpen:r}}function $s(t){return{type:1,lower:t,upper:t}}var Cs=function(){function t(){}return Object.defineProperty(t.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),t.prototype.between=function(e,n,r,i){r=r!==!1,i=i===!0;try{return this._cmp(e,n)>0||this._cmp(e,n)===0&&(r||i)&&!(r&&i)?He(this):new this.Collection(this,function(){return ge(e,n,!r,!i)})}catch{return Y(this,le)}},t.prototype.equals=function(e){return e==null?Y(this,le):new this.Collection(this,function(){return $s(e)})},t.prototype.above=function(e){return e==null?Y(this,le):new this.Collection(this,function(){return ge(e,void 0,!0)})},t.prototype.aboveOrEqual=function(e){return e==null?Y(this,le):new this.Collection(this,function(){return ge(e,void 0,!1)})},t.prototype.below=function(e){return e==null?Y(this,le):new this.Collection(this,function(){return ge(void 0,e,!1,!0)})},t.prototype.belowOrEqual=function(e){return e==null?Y(this,le):new this.Collection(this,function(){return ge(void 0,e)})},t.prototype.startsWith=function(e){return typeof e!="string"?Y(this,Es):this.between(e,e+Oe,!0,!0)},t.prototype.startsWithIgnoreCase=function(e){return e===""?this.startsWith(e):zt(this,function(n,r){return n.indexOf(r[0])===0},[e],Oe)},t.prototype.equalsIgnoreCase=function(e){return zt(this,function(n,r){return n===r[0]},[e],"")},t.prototype.anyOfIgnoreCase=function(){var e=fe.apply(je,arguments);return e.length===0?He(this):zt(this,function(n,r){return r.indexOf(n)!==-1},e,"")},t.prototype.startsWithAnyOfIgnoreCase=function(){var e=fe.apply(je,arguments);return e.length===0?He(this):zt(this,function(n,r){return r.some(function(i){return n.indexOf(i)===0})},e,Oe)},t.prototype.anyOf=function(){var e=this,n=fe.apply(je,arguments),r=this._cmp;try{n.sort(r)}catch{return Y(this,le)}if(n.length===0)return He(this);var i=new this.Collection(this,function(){return ge(n[0],n[n.length-1])});i._ondirectionchange=function(o){r=o==="next"?e._ascending:e._descending,n.sort(r)};var s=0;return i._addAlgorithm(function(o,a,u){for(var l=o.key;r(l,n[s])>0;)if(++s,s===n.length)return a(u),!1;return r(l,n[s])===0?!0:(a(function(){o.continue(n[s])}),!1)}),i},t.prototype.notEqual=function(e){return this.inAnyRange([[rr,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},t.prototype.noneOf=function(){var e=fe.apply(je,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return Y(this,le)}var n=e.reduce(function(r,i){return r?r.concat([[r[r.length-1][1],i]]):[[rr,i]]},null);return n.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})},t.prototype.inAnyRange=function(e,n){var r=this,i=this._cmp,s=this._ascending,o=this._descending,a=this._min,u=this._max;if(e.length===0)return He(this);if(!e.every(function(v){return v[0]!==void 0&&v[1]!==void 0&&s(v[0],v[1])<=0}))return Y(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",T.InvalidArgument);var l=!n||n.includeLowers!==!1,f=n&&n.includeUppers===!0;function c(v,_){for(var $=0,E=v.length;$<E;++$){var C=v[$];if(i(_[0],C[1])<0&&i(_[1],C[0])>0){C[0]=a(C[0],_[0]),C[1]=u(C[1],_[1]);break}}return $===E&&v.push(_),v}var h=s;function m(v,_){return h(v[0],_[0])}var p;try{p=e.reduce(c,[]),p.sort(m)}catch{return Y(this,le)}var d=0,y=f?function(v){return s(v,p[d][1])>0}:function(v){return s(v,p[d][1])>=0},b=l?function(v){return o(v,p[d][0])>0}:function(v){return o(v,p[d][0])>=0};function S(v){return!y(v)&&!b(v)}var g=y,w=new this.Collection(this,function(){return ge(p[0][0],p[p.length-1][1],!l,!f)});return w._ondirectionchange=function(v){v==="next"?(g=y,h=s):(g=b,h=o),p.sort(m)},w._addAlgorithm(function(v,_,$){for(var E=v.key;g(E);)if(++d,d===p.length)return _($),!1;return S(E)?!0:(r._cmp(E,p[d][1])===0||r._cmp(E,p[d][0])===0||_(function(){h===s?v.continue(p[d][0]):v.continue(p[d][1])}),!1)}),w},t.prototype.startsWithAnyOf=function(){var e=fe.apply(je,arguments);return e.every(function(n){return typeof n=="string"})?e.length===0?He(this):this.inAnyRange(e.map(function(n){return[n,n+Oe]})):Y(this,"startsWithAnyOf() only works with strings")},t}();function ja(t){return Dt(Cs.prototype,function(n,r,i){this.db=t,this._ctx={table:n,index:r===":id"?null:r,or:i};var s=t._deps.indexedDB;if(!s)throw new T.MissingAPI;this._cmp=this._ascending=s.cmp.bind(s),this._descending=function(o,a){return s.cmp(a,o)},this._max=function(o,a){return s.cmp(o,a)>0?o:a},this._min=function(o,a){return s.cmp(o,a)<0?o:a},this._IDBKeyRange=t._deps.IDBKeyRange})}function oe(t){return K(function(e){return St(e),t(e.target.error),!1})}function St(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()}var Et="storagemutated",_e="x-storagemutated-1",Ce=kt(null,Et),Va=function(){function t(){}return t.prototype._lock=function(){return st(!A.global),++this._reculock,this._reculock===1&&!A.global&&(A.lockOwnerFor=this),this},t.prototype._unlock=function(){if(st(!A.global),--this._reculock===0)for(A.global||(A.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{tt(e[1],e[0])}catch{}}return this},t.prototype._locked=function(){return this._reculock&&A.lockOwnerFor!==this},t.prototype.create=function(e){var n=this;if(!this.mode)return this;var r=this.db.idbdb,i=this.db._state.dbOpenError;if(st(!this.idbtrans),!e&&!r)switch(i&&i.name){case"DatabaseClosedError":throw new T.DatabaseClosed(i);case"MissingAPIError":throw new T.MissingAPI(i.message,i);default:throw new T.OpenFailed(i)}if(!this.active)throw new T.TransactionInactive;return st(this._completion._state===null),e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):r.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})),e.onerror=K(function(s){St(s),n._reject(e.error)}),e.onabort=K(function(s){St(s),n.active&&n._reject(new T.Abort(e.error)),n.active=!1,n.on("abort").fire(s)}),e.oncomplete=K(function(){n.active=!1,n._resolve(),"mutatedParts"in e&&Ce.storagemutated.fire(e.mutatedParts)}),this},t.prototype._promise=function(e,n,r){var i=this;if(e==="readwrite"&&this.mode!=="readwrite")return L(new T.ReadOnly("Transaction is readonly"));if(!this.active)return L(new T.TransactionInactive);if(this._locked())return new x(function(o,a){i._blockedFuncs.push([function(){i._promise(e,n,r).then(o,a)},A])});if(r)return Ae(function(){var o=new x(function(a,u){i._lock();var l=n(a,u,i);l&&l.then&&l.then(a,u)});return o.finally(function(){return i._unlock()}),o._lib=!0,o});var s=new x(function(o,a){var u=n(o,a,i);u&&u.then&&u.then(o,a)});return s._lib=!0,s},t.prototype._root=function(){return this.parent?this.parent._root():this},t.prototype.waitFor=function(e){var n=this._root(),r=x.resolve(e);if(n._waitingFor)n._waitingFor=n._waitingFor.then(function(){return r});else{n._waitingFor=r,n._waitingQueue=[];var i=n.idbtrans.objectStore(n.storeNames[0]);(function o(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(i.get(-1/0).onsuccess=o)})()}var s=n._waitingFor;return new x(function(o,a){r.then(function(u){return n._waitingQueue.push(K(o.bind(null,u)))},function(u){return n._waitingQueue.push(K(a.bind(null,u)))}).finally(function(){n._waitingFor===s&&(n._waitingFor=null)})})},t.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new T.Abort))},t.prototype.table=function(e){var n=this._memoizedTables||(this._memoizedTables={});if(Q(n,e))return n[e];var r=this.schema[e];if(!r)throw new T.NotFound("Table "+e+" not part of transaction");var i=new this.db.Table(e,r,this);return i.core=this.db.core.table(e),n[e]=i,i},t}();function Wa(t){return Dt(Va.prototype,function(n,r,i,s,o){var a=this;this.db=t,this.mode=n,this.storeNames=r,this.schema=i,this.chromeTransactionDurability=s,this.idbtrans=null,this.on=kt(this,"complete","error","abort"),this.parent=o||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new x(function(u,l){a._resolve=u,a._reject=l}),this._completion.then(function(){a.active=!1,a.on.complete.fire()},function(u){var l=a.active;return a.active=!1,a.on.error.fire(u),a.parent?a.parent._reject(u):l&&a.idbtrans&&a.idbtrans.abort(),L(u)})})}function ir(t,e,n,r,i,s,o){return{name:t,keyPath:e,unique:n,multi:r,auto:i,compound:s,src:(n&&!o?"&":"")+(r?"*":"")+(i?"++":"")+Ts(e)}}function Ts(t){return typeof t=="string"?t:t?"["+[].join.call(t,"+")+"]":""}function Ps(t,e,n){return{name:t,primKey:e,indexes:n,mappedClass:null,idxByName:os(n,function(r){return[r.name,r]})}}function Ga(t){return t.length===1?t[0]:t}var xt=function(t){try{return t.only([[]]),xt=function(){return[[]]},[[]]}catch{return xt=function(){return Oe},Oe}};function sr(t){return t==null?function(){}:typeof t=="string"?Ja(t):function(e){return de(e,t)}}function Ja(t){var e=t.split(".");return e.length===1?function(n){return n[t]}:function(n){return de(n,t)}}function gi(t){return[].slice.call(t)}var Ya=0;function ht(t){return t==null?":id":typeof t=="string"?t:"["+t.join("+")+"]"}function qa(t,e,n){function r(c,h){var m=gi(c.objectStoreNames);return{schema:{name:c.name,tables:m.map(function(p){return h.objectStore(p)}).map(function(p){var d=p.keyPath,y=p.autoIncrement,b=j(d),S=d==null,g={},w={name:p.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:S,compound:b,keyPath:d,autoIncrement:y,unique:!0,extractKey:sr(d)},indexes:gi(p.indexNames).map(function(v){return p.index(v)}).map(function(v){var _=v.name,$=v.unique,E=v.multiEntry,C=v.keyPath,P=j(C),M={name:_,compound:P,keyPath:C,unique:$,multiEntry:E,extractKey:sr(C)};return g[ht(C)]=M,M}),getIndexByKeyPath:function(v){return g[ht(v)]}};return g[":id"]=w.primaryKey,d!=null&&(g[ht(d)]=w.primaryKey),w})},hasGetAll:m.length>0&&"getAll"in h.objectStore(m[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}function i(c){if(c.type===3)return null;if(c.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var h=c.lower,m=c.upper,p=c.lowerOpen,d=c.upperOpen,y=h===void 0?m===void 0?null:e.upperBound(m,!!d):m===void 0?e.lowerBound(h,!!p):e.bound(h,m,!!p,!!d);return y}function s(c){var h=c.name;function m(y){var b=y.trans,S=y.type,g=y.keys,w=y.values,v=y.range;return new Promise(function(_,$){_=K(_);var E=b.objectStore(h),C=E.keyPath==null,P=S==="put"||S==="add";if(!P&&S!=="delete"&&S!=="deleteRange")throw new Error("Invalid operation type: "+S);var M=(g||w||{length:1}).length;if(g&&w&&g.length!==w.length)throw new Error("Given keys array must have same length as given values array.");if(M===0)return _({numFailures:0,failures:{},results:[],lastResult:void 0});var B,D=[],F=[],R=0,X=function(se){++R,St(se)};if(S==="deleteRange"){if(v.type===4)return _({numFailures:R,failures:F,results:[],lastResult:void 0});v.type===3?D.push(B=E.clear()):D.push(B=E.delete(i(v)))}else{var ee=P?C?[w,g]:[w,null]:[g,null],me=ee[0],ie=ee[1];if(P)for(var Z=0;Z<M;++Z)D.push(B=ie&&ie[Z]!==void 0?E[S](me[Z],ie[Z]):E[S](me[Z])),B.onerror=X;else for(var Z=0;Z<M;++Z)D.push(B=E[S](me[Z])),B.onerror=X}var ye=function(se){var nt=se.target.result;D.forEach(function(te,Mt){return te.error!=null&&(F[Mt]=te.error)}),_({numFailures:R,failures:F,results:S==="delete"?g:D.map(function(te){return te.result}),lastResult:nt})};B.onerror=function(se){X(se),ye(se)},B.onsuccess=ye})}function p(y){var b=y.trans,S=y.values,g=y.query,w=y.reverse,v=y.unique;return new Promise(function(_,$){_=K(_);var E=g.index,C=g.range,P=b.objectStore(h),M=E.isPrimaryKey?P:P.index(E.name),B=w?v?"prevunique":"prev":v?"nextunique":"next",D=S||!("openKeyCursor"in M)?M.openCursor(i(C),B):M.openKeyCursor(i(C),B);D.onerror=oe($),D.onsuccess=K(function(F){var R=D.result;if(!R){_(null);return}R.___id=++Ya,R.done=!1;var X=R.continue.bind(R),ee=R.continuePrimaryKey;ee&&(ee=ee.bind(R));var me=R.advance.bind(R),ie=function(){throw new Error("Cursor not started")},Z=function(){throw new Error("Cursor not stopped")};R.trans=b,R.stop=R.continue=R.continuePrimaryKey=R.advance=ie,R.fail=K($),R.next=function(){var ye=this,se=1;return this.start(function(){return se--?ye.continue():ye.stop()}).then(function(){return ye})},R.start=function(ye){var se=new Promise(function(te,Mt){te=K(te),D.onerror=oe(Mt),R.fail=Mt,R.stop=function(Is){R.stop=R.continue=R.continuePrimaryKey=R.advance=Z,te(Is)}}),nt=function(){if(D.result)try{ye()}catch(te){R.fail(te)}else R.done=!0,R.start=function(){throw new Error("Cursor behind last entry")},R.stop()};return D.onsuccess=K(function(te){D.onsuccess=nt,nt()}),R.continue=X,R.continuePrimaryKey=ee,R.advance=me,nt(),se},_(R)},$)})}function d(y){return function(b){return new Promise(function(S,g){S=K(S);var w=b.trans,v=b.values,_=b.limit,$=b.query,E=_===1/0?void 0:_,C=$.index,P=$.range,M=w.objectStore(h),B=C.isPrimaryKey?M:M.index(C.name),D=i(P);if(_===0)return S({result:[]});if(y){var F=v?B.getAll(D,E):B.getAllKeys(D,E);F.onsuccess=function(me){return S({result:me.target.result})},F.onerror=oe(g)}else{var R=0,X=v||!("openKeyCursor"in B)?B.openCursor(D):B.openKeyCursor(D),ee=[];X.onsuccess=function(me){var ie=X.result;if(!ie)return S({result:ee});if(ee.push(v?ie.value:ie.primaryKey),++R===_)return S({result:ee});ie.continue()},X.onerror=oe(g)}})}}return{name:h,schema:c,mutate:m,getMany:function(y){var b=y.trans,S=y.keys;return new Promise(function(g,w){g=K(g);for(var v=b.objectStore(h),_=S.length,$=new Array(_),E=0,C=0,P,M=function(R){var X=R.target;($[X._pos]=X.result)!=null,++C===E&&g($)},B=oe(w),D=0;D<_;++D){var F=S[D];F!=null&&(P=v.get(S[D]),P._pos=D,P.onsuccess=M,P.onerror=B,++E)}E===0&&g($)})},get:function(y){var b=y.trans,S=y.key;return new Promise(function(g,w){g=K(g);var v=b.objectStore(h),_=v.get(S);_.onsuccess=function($){return g($.target.result)},_.onerror=oe(w)})},query:d(u),openCursor:p,count:function(y){var b=y.query,S=y.trans,g=b.index,w=b.range;return new Promise(function(v,_){var $=S.objectStore(h),E=g.isPrimaryKey?$:$.index(g.name),C=i(w),P=C?E.count(C):E.count();P.onsuccess=K(function(M){return v(M.target.result)}),P.onerror=oe(_)})}}}var o=r(t,n),a=o.schema,u=o.hasGetAll,l=a.tables.map(function(c){return s(c)}),f={};return l.forEach(function(c){return f[c.name]=c}),{stack:"dbcore",transaction:t.transaction.bind(t),table:function(c){var h=f[c];if(!h)throw new Error("Table '"+c+"' not found");return f[c]},MIN_KEY:-1/0,MAX_KEY:xt(e),schema:a}}function Qa(t,e){return e.reduce(function(n,r){var i=r.create;return k(k({},n),i(n))},t)}function Xa(t,e,n,r){var i=n.IDBKeyRange;n.indexedDB;var s=Qa(qa(e,i,r),t.dbcore);return{dbcore:s}}function Pr(t,e){var n=t._novip,r=e.db,i=Xa(n._middlewares,r,n._deps,e);n.core=i.dbcore,n.tables.forEach(function(s){var o=s.name;n.core.schema.tables.some(function(a){return a.name===o})&&(s.core=n.core.table(o),n[o]instanceof n.Table&&(n[o].core=s.core))})}function un(t,e,n,r){var i=t._novip;n.forEach(function(s){var o=r[s];e.forEach(function(a){var u=br(a,s);(!u||"value"in u&&u.value===void 0)&&(a===i.Transaction.prototype||a instanceof i.Transaction?pe(a,s,{get:function(){return this.table(s)},set:function(l){rs(this,s,{value:l,writable:!0,configurable:!0,enumerable:!0})}}):a[s]=new i.Table(s,o))})})}function or(t,e){var n=t._novip;e.forEach(function(r){for(var i in r)r[i]instanceof n.Table&&delete r[i]})}function Za(t,e){return t._cfg.version-e._cfg.version}function eu(t,e,n,r){var i=t._dbSchema,s=t._createTransaction("readwrite",t._storeNames,i);s.create(n),s._completion.catch(r);var o=s._reject.bind(s),a=A.transless||A;Ae(function(){A.trans=s,A.transless=a,e===0?(z(i).forEach(function(u){Rr(n,u,i[u].primKey,i[u].indexes)}),Pr(t,n),x.follow(function(){return t.on.populate.fire(s)}).catch(o)):tu(t,e,s,n).catch(o)})}function tu(t,e,n,r){var i=t._novip,s=[],o=i._versions,a=i._dbSchema=kr(i,i.idbdb,r),u=!1,l=o.filter(function(c){return c._cfg.version>=e});l.forEach(function(c){s.push(function(){var h=a,m=c._cfg.dbschema;ur(i,h,r),ur(i,m,r),a=i._dbSchema=m;var p=Rs(h,m);p.add.forEach(function(w){Rr(r,w[0],w[1].primKey,w[1].indexes)}),p.change.forEach(function(w){if(w.recreate)throw new T.Upgrade("Not yet support for changing primary key");var v=r.objectStore(w.name);w.add.forEach(function(_){return ar(v,_)}),w.change.forEach(function(_){v.deleteIndex(_.name),ar(v,_)}),w.del.forEach(function(_){return v.deleteIndex(_)})});var d=c._cfg.contentUpgrade;if(d&&c._cfg.version>e){Pr(i,r),n._memoizedTables={},u=!0;var y=as(m);p.del.forEach(function(w){y[w]=h[w]}),or(i,[i.Transaction.prototype]),un(i,[i.Transaction.prototype],z(y),y),n.schema=y;var b=_r(d);b&&et();var S,g=x.follow(function(){if(S=d(n),S&&b){var w=ve.bind(null,null);S.then(w,w)}});return S&&typeof S.then=="function"?x.resolve(S):g.then(function(){return S})}}),s.push(function(h){if(!u||!Ra){var m=c._cfg.dbschema;ru(m,h)}or(i,[i.Transaction.prototype]),un(i,[i.Transaction.prototype],i._storeNames,i._dbSchema),n.schema=i._dbSchema})});function f(){return s.length?x.resolve(s.shift()(n.idbtrans)).then(f):x.resolve()}return f().then(function(){nu(a,r)})}function Rs(t,e){var n={del:[],add:[],change:[]},r;for(r in t)e[r]||n.del.push(r);for(r in e){var i=t[r],s=e[r];if(!i)n.add.push([r,s]);else{var o={name:r,def:s,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(s.primKey.keyPath||"")||i.primKey.auto!==s.primKey.auto&&!mn)o.recreate=!0,n.change.push(o);else{var a=i.idxByName,u=s.idxByName,l=void 0;for(l in a)u[l]||o.del.push(l);for(l in u){var f=a[l],c=u[l];f?f.src!==c.src&&o.change.push(c):o.add.push(c)}(o.del.length>0||o.add.length>0||o.change.length>0)&&n.change.push(o)}}}return n}function Rr(t,e,n,r){var i=t.db.createObjectStore(e,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(function(s){return ar(i,s)}),i}function nu(t,e){z(t).forEach(function(n){e.db.objectStoreNames.contains(n)||Rr(e,n,t[n].primKey,t[n].indexes)})}function ru(t,e){[].slice.call(e.db.objectStoreNames).forEach(function(n){return t[n]==null&&e.db.deleteObjectStore(n)})}function ar(t,e){t.createIndex(e.name,e.keyPath,{unique:e.unique,multiEntry:e.multi})}function kr(t,e,n){var r={},i=pn(e.objectStoreNames,0);return i.forEach(function(s){for(var o=n.objectStore(s),a=o.keyPath,u=ir(Ts(a),a||"",!1,!1,!!o.autoIncrement,a&&typeof a!="string",!0),l=[],f=0;f<o.indexNames.length;++f){var c=o.index(o.indexNames[f]);a=c.keyPath;var h=ir(c.name,a,!!c.unique,!!c.multiEntry,!1,a&&typeof a!="string",!1);l.push(h)}r[s]=Ps(s,u,l)}),r}function iu(t,e,n){var r=t._novip;r.verno=e.version/10;var i=r._dbSchema=kr(r,e,n);r._storeNames=pn(e.objectStoreNames,0),un(r,[r._allTables],z(i),i)}function su(t,e){var n=kr(t,t.idbdb,e),r=Rs(n,t._dbSchema);return!(r.add.length||r.change.some(function(i){return i.add.length||i.change.length}))}function ur(t,e,n){for(var r=t._novip,i=n.db.objectStoreNames,s=0;s<i.length;++s){var o=i[s],a=n.objectStore(o);r._hasGetAll="getAll"in a;for(var u=0;u<a.indexNames.length;++u){var l=a.indexNames[u],f=a.index(l).keyPath,c=typeof f=="string"?f:"["+pn(f).join("+")+"]";if(e[o]){var h=e[o].idxByName[c];h&&(h.name=l,delete e[o].idxByName[c],e[o].idxByName[l]=h)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&I.WorkerGlobalScope&&I instanceof I.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(r._hasGetAll=!1)}function ou(t){return t.split(",").map(function(e,n){e=e.trim();var r=e.replace(/([&*]|\+\+)/g,""),i=/^\[/.test(r)?r.match(/^\[(.*)\]$/)[1].split("+"):r;return ir(r,i||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),j(i),n===0)})}var au=function(){function t(){}return t.prototype._parseStoresSpec=function(e,n){z(e).forEach(function(r){if(e[r]!==null){var i=ou(e[r]),s=i.shift();if(s.multi)throw new T.Schema("Primary key cannot be multi-valued");i.forEach(function(o){if(o.auto)throw new T.Schema("Only primary key can be marked as autoIncrement (++)");if(!o.keyPath)throw new T.Schema("Index must have a name and cannot be an empty string")}),n[r]=Ps(r,s,i)}})},t.prototype.stores=function(e){var n=this.db;this._cfg.storesSource=this._cfg.storesSource?W(this._cfg.storesSource,e):e;var r=n._versions,i={},s={};return r.forEach(function(o){W(i,o._cfg.storesSource),s=o._cfg.dbschema={},o._parseStoresSpec(i,s)}),n._dbSchema=s,or(n,[n._allTables,n,n.Transaction.prototype]),un(n,[n._allTables,n,n.Transaction.prototype,this._cfg.tables],z(s),s),n._storeNames=z(s),this},t.prototype.upgrade=function(e){return this._cfg.contentUpgrade=xr(this._cfg.contentUpgrade||N,e),this},t}();function uu(t){return Dt(au.prototype,function(n){this.db=t,this._cfg={version:n,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}function Dr(t,e){var n=t._dbNamesDB;return n||(n=t._dbNamesDB=new Nr(yn,{addons:[],indexedDB:t,IDBKeyRange:e}),n.version(1).stores({dbnames:"name"})),n.table("dbnames")}function Or(t){return t&&typeof t.databases=="function"}function lu(t){var e=t.indexedDB,n=t.IDBKeyRange;return Or(e)?Promise.resolve(e.databases()).then(function(r){return r.map(function(i){return i.name}).filter(function(i){return i!==yn})}):Dr(e,n).toCollection().primaryKeys()}function cu(t,e){var n=t.indexedDB,r=t.IDBKeyRange;!Or(n)&&e!==yn&&Dr(n,r).put({name:e}).catch(N)}function fu(t,e){var n=t.indexedDB,r=t.IDBKeyRange;!Or(n)&&e!==yn&&Dr(n,r).delete(e).catch(N)}function lr(t){return Ae(function(){return A.letThrough=!0,t()})}function hu(){var t=!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent);if(!t||!indexedDB.databases)return Promise.resolve();var e;return new Promise(function(n){var r=function(){return indexedDB.databases().finally(n)};e=setInterval(r,100),r()}).finally(function(){return clearInterval(e)})}function du(t){var e=t._state,n=t._deps.indexedDB;if(e.isBeingOpened||t.idbdb)return e.dbReadyPromise.then(function(){return e.dbOpenError?L(e.dbOpenError):t});ue&&(e.openCanceller._stackHolder=ze()),e.isBeingOpened=!0,e.dbOpenError=null,e.openComplete=!1;var r=e.openCanceller;function i(){if(e.openCanceller!==r)throw new T.DatabaseClosed("db.open() was cancelled")}var s=e.dbReadyResolve,o=null,a=!1;return x.race([r,(typeof navigator>"u"?x.resolve():hu()).then(function(){return new x(function(u,l){if(i(),!n)throw new T.MissingAPI;var f=t.name,c=e.autoSchema?n.open(f):n.open(f,Math.round(t.verno*10));if(!c)throw new T.MissingAPI;c.onerror=oe(l),c.onblocked=K(t._fireOnBlocked),c.onupgradeneeded=K(function(h){if(o=c.transaction,e.autoSchema&&!t._options.allowEmptyDB){c.onerror=St,o.abort(),c.result.close();var m=n.deleteDatabase(f);m.onsuccess=m.onerror=K(function(){l(new T.NoSuchDatabase("Database "+f+" doesnt exist"))})}else{o.onerror=oe(l);var p=h.oldVersion>Math.pow(2,62)?0:h.oldVersion;a=p<1,t._novip.idbdb=c.result,eu(t,p/10,o,l)}},l),c.onsuccess=K(function(){o=null;var h=t._novip.idbdb=c.result,m=pn(h.objectStoreNames);if(m.length>0)try{var p=h.transaction(Ga(m),"readonly");e.autoSchema?iu(t,h,p):(ur(t,t._dbSchema,p),su(t,p)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),Pr(t,p)}catch{}ft.push(t),h.onversionchange=K(function(d){e.vcFired=!0,t.on("versionchange").fire(d)}),h.onclose=K(function(d){t.on("close").fire(d)}),a&&cu(t._deps,f),u()},l)})})]).then(function(){return i(),e.onReadyBeingFired=[],x.resolve(lr(function(){return t.on.ready.fire(t.vip)})).then(function u(){if(e.onReadyBeingFired.length>0){var l=e.onReadyBeingFired.reduce(xr,N);return e.onReadyBeingFired=[],x.resolve(lr(function(){return l(t.vip)})).then(u)}})}).finally(function(){e.onReadyBeingFired=null,e.isBeingOpened=!1}).then(function(){return t}).catch(function(u){e.dbOpenError=u;try{o&&o.abort()}catch{}return r===e.openCanceller&&t._close(),L(u)}).finally(function(){e.openComplete=!0,s()})}function cr(t){var e=function(o){return t.next(o)},n=function(o){return t.throw(o)},r=s(e),i=s(n);function s(o){return function(a){var u=o(a),l=u.value;return u.done?l:!l||typeof l.then!="function"?j(l)?Promise.all(l).then(r,i):r(l):l.then(r,i)}}return s(e)()}function pu(t,e,n){var r=arguments.length;if(r<2)throw new T.InvalidArgument("Too few arguments");for(var i=new Array(r-1);--r;)i[r-1]=arguments[r];n=i.pop();var s=us(i);return[t,s,n]}function ks(t,e,n,r,i){return x.resolve().then(function(){var s=A.transless||A,o=t._createTransaction(e,n,t._dbSchema,r),a={trans:o,transless:s};if(r)o.idbtrans=r.idbtrans;else try{o.create(),t._state.PR1398_maxLoop=3}catch(c){return c.name===Er.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(function(){return ks(t,e,n,null,i)})):L(c)}var u=_r(i);u&&et();var l,f=x.follow(function(){if(l=i.call(o,o),l)if(u){var c=ve.bind(null,null);l.then(c,c)}else typeof l.next=="function"&&typeof l.throw=="function"&&(l=cr(l))},a);return(l&&typeof l.then=="function"?x.resolve(l).then(function(c){return o.active?c:L(new T.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):f.then(function(){return l})).then(function(c){return r&&o._resolve(),o._completion.then(function(){return c})}).catch(function(c){return o._reject(c),L(c)})})}function Lt(t,e,n){for(var r=j(t)?t.slice():[t],i=0;i<n;++i)r.push(e);return r}function vu(t){return k(k({},t),{table:function(e){var n=t.table(e),r=n.schema,i={},s=[];function o(d,y,b){var S=ht(d),g=i[S]=i[S]||[],w=d==null?0:typeof d=="string"?1:d.length,v=y>0,_=k(k({},b),{isVirtual:v,keyTail:y,keyLength:w,extractKey:sr(d),unique:!v&&b.unique});if(g.push(_),_.isPrimaryKey||s.push(_),w>1){var $=w===2?d[0]:d.slice(0,w-1);o($,y+1,b)}return g.sort(function(E,C){return E.keyTail-C.keyTail}),_}var a=o(r.primaryKey.keyPath,0,r.primaryKey);i[":id"]=[a];for(var u=0,l=r.indexes;u<l.length;u++){var f=l[u];o(f.keyPath,0,f)}function c(d){var y=i[ht(d)];return y&&y[0]}function h(d,y){return{type:d.type===1?2:d.type,lower:Lt(d.lower,d.lowerOpen?t.MAX_KEY:t.MIN_KEY,y),lowerOpen:!0,upper:Lt(d.upper,d.upperOpen?t.MIN_KEY:t.MAX_KEY,y),upperOpen:!0}}function m(d){var y=d.query.index;return y.isVirtual?k(k({},d),{query:{index:y,range:h(d.query.range,y.keyTail)}}):d}var p=k(k({},n),{schema:k(k({},r),{primaryKey:a,indexes:s,getIndexByKeyPath:c}),count:function(d){return n.count(m(d))},query:function(d){return n.query(m(d))},openCursor:function(d){var y=d.query.index,b=y.keyTail,S=y.isVirtual,g=y.keyLength;if(!S)return n.openCursor(d);function w(v){function _(E){E!=null?v.continue(Lt(E,d.reverse?t.MAX_KEY:t.MIN_KEY,b)):d.unique?v.continue(v.key.slice(0,g).concat(d.reverse?t.MIN_KEY:t.MAX_KEY,b)):v.continue()}var $=Object.create(v,{continue:{value:_},continuePrimaryKey:{value:function(E,C){v.continuePrimaryKey(Lt(E,t.MAX_KEY,b),C)}},primaryKey:{get:function(){return v.primaryKey}},key:{get:function(){var E=v.key;return g===1?E[0]:E.slice(0,g)}},value:{get:function(){return v.value}}});return $}return n.openCursor(m(d)).then(function(v){return v&&w(v)})}});return p}})}var mu={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:vu};function Mr(t,e,n,r){return n=n||{},r=r||"",z(t).forEach(function(i){if(!Q(e,i))n[r+i]=void 0;else{var s=t[i],o=e[i];if(typeof s=="object"&&typeof o=="object"&&s&&o){var a=Vn(s),u=Vn(o);a!==u?n[r+i]=e[i]:a==="Object"?Mr(s,o,n,r+i+"."):s!==o&&(n[r+i]=e[i])}else s!==o&&(n[r+i]=e[i])}}),z(e).forEach(function(i){Q(t,i)||(n[r+i]=e[i])}),n}function yu(t,e){return e.type==="delete"?e.keys:e.keys||e.values.map(t.extractKey)}var gu={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(t){return k(k({},t),{table:function(e){var n=t.table(e),r=n.schema.primaryKey,i=k(k({},n),{mutate:function(s){var o=A.trans,a=o.table(e).hook,u=a.deleting,l=a.creating,f=a.updating;switch(s.type){case"add":if(l.fire===N)break;return o._promise("readwrite",function(){return c(s)},!0);case"put":if(l.fire===N&&f.fire===N)break;return o._promise("readwrite",function(){return c(s)},!0);case"delete":if(u.fire===N)break;return o._promise("readwrite",function(){return c(s)},!0);case"deleteRange":if(u.fire===N)break;return o._promise("readwrite",function(){return h(s)},!0)}return n.mutate(s);function c(p){var d=A.trans,y=p.keys||yu(r,p);if(!y)throw new Error("Keys missing");return p=p.type==="add"||p.type==="put"?k(k({},p),{keys:y}):k({},p),p.type!=="delete"&&(p.values=Un([],p.values,!0)),p.keys&&(p.keys=Un([],p.keys,!0)),wu(n,p,y).then(function(b){var S=y.map(function(g,w){var v=b[w],_={onerror:null,onsuccess:null};if(p.type==="delete")u.fire.call(_,g,v,d);else if(p.type==="add"||v===void 0){var $=l.fire.call(_,g,p.values[w],d);g==null&&$!=null&&(g=$,p.keys[w]=g,r.outbound||re(p.values[w],r.keyPath,g))}else{var E=Mr(v,p.values[w]),C=f.fire.call(_,E,g,v,d);if(C){var P=p.values[w];Object.keys(C).forEach(function(M){Q(P,M)?P[M]=C[M]:re(P,M,C[M])})}}return _});return n.mutate(p).then(function(g){for(var w=g.failures,v=g.results,_=g.numFailures,$=g.lastResult,E=0;E<y.length;++E){var C=v?v[E]:y[E],P=S[E];C==null?P.onerror&&P.onerror(w[E]):P.onsuccess&&P.onsuccess(p.type==="put"&&b[E]?p.values[E]:C)}return{failures:w,results:v,numFailures:_,lastResult:$}}).catch(function(g){return S.forEach(function(w){return w.onerror&&w.onerror(g)}),Promise.reject(g)})})}function h(p){return m(p.trans,p.range,1e4)}function m(p,d,y){return n.query({trans:p,values:!1,query:{index:r,range:d},limit:y}).then(function(b){var S=b.result;return c({type:"delete",keys:S,trans:p}).then(function(g){return g.numFailures>0?Promise.reject(g.failures[0]):S.length<y?{failures:[],numFailures:0,lastResult:void 0}:m(p,k(k({},d),{lower:S[S.length-1],lowerOpen:!0}),y)})})}}});return i}})}};function wu(t,e,n){return e.type==="add"?Promise.resolve([]):t.getMany({trans:e.trans,keys:n,cache:"immutable"})}function Ds(t,e,n){try{if(!e||e.keys.length<t.length)return null;for(var r=[],i=0,s=0;i<e.keys.length&&s<t.length;++i)V(e.keys[i],t[s])===0&&(r.push(n?Ct(e.values[i]):e.values[i]),++s);return r.length===t.length?r:null}catch{return null}}var bu={stack:"dbcore",level:-1,create:function(t){return{table:function(e){var n=t.table(e);return k(k({},n),{getMany:function(r){if(!r.cache)return n.getMany(r);var i=Ds(r.keys,r.trans._cache,r.cache==="clone");return i?x.resolve(i):n.getMany(r).then(function(s){return r.trans._cache={keys:r.keys,values:r.cache==="clone"?Ct(s):s},s})},mutate:function(r){return r.type!=="add"&&(r.trans._cache=null),n.mutate(r)}})}}}},Dn;function Br(t){return!("from"in t)}var ce=function(t,e){if(this)W(this,arguments.length?{d:1,from:t,to:arguments.length>1?e:t}:{d:0});else{var n=new ce;return t&&"d"in t&&W(n,t),n}};Qe(ce.prototype,(Dn={add:function(t){return ln(this,t),this},addKey:function(t){return At(this,t,t),this},addKeys:function(t){var e=this;return t.forEach(function(n){return At(e,n,n)}),this}},Dn[Wn]=function(){return fr(this)},Dn));function At(t,e,n){var r=V(e,n);if(!isNaN(r)){if(r>0)throw RangeError();if(Br(t))return W(t,{from:e,to:n,d:1});var i=t.l,s=t.r;if(V(n,t.from)<0)return i?At(i,e,n):t.l={from:e,to:n,d:1,l:null,r:null},wi(t);if(V(e,t.to)>0)return s?At(s,e,n):t.r={from:e,to:n,d:1,l:null,r:null},wi(t);V(e,t.from)<0&&(t.from=e,t.l=null,t.d=s?s.d+1:1),V(n,t.to)>0&&(t.to=n,t.r=null,t.d=t.l?t.l.d+1:1);var o=!t.r;i&&!t.l&&ln(t,i),s&&o&&ln(t,s)}}function ln(t,e){function n(r,i){var s=i.from,o=i.to,a=i.l,u=i.r;At(r,s,o),a&&n(r,a),u&&n(r,u)}Br(e)||n(t,e)}function _u(t,e){var n=fr(e),r=n.next();if(r.done)return!1;for(var i=r.value,s=fr(t),o=s.next(i.from),a=o.value;!r.done&&!o.done;){if(V(a.from,i.to)<=0&&V(a.to,i.from)>=0)return!0;V(i.from,a.from)<0?i=(r=n.next(a.from)).value:a=(o=s.next(i.from)).value}return!1}function fr(t){var e=Br(t)?null:{s:0,n:t};return{next:function(n){for(var r=arguments.length>0;e;)switch(e.s){case 0:if(e.s=1,r)for(;e.n.l&&V(n,e.n.from)<0;)e={up:e,n:e.n.l,s:1};else for(;e.n.l;)e={up:e,n:e.n.l,s:1};case 1:if(e.s=2,!r||V(n,e.n.to)<=0)return{value:e.n,done:!1};case 2:if(e.n.r){e.s=3,e={up:e,n:e.n.r,s:0};continue}case 3:e=e.up}return{done:!0}}}}function wi(t){var e,n,r=(((e=t.r)===null||e===void 0?void 0:e.d)||0)-(((n=t.l)===null||n===void 0?void 0:n.d)||0),i=r>1?"r":r<-1?"l":"";if(i){var s=i==="r"?"l":"r",o=k({},t),a=t[i];t.from=a.from,t.to=a.to,t[i]=a[i],o[i]=a[s],t[s]=o,o.d=bi(o)}t.d=bi(t)}function bi(t){var e=t.r,n=t.l;return(e?n?Math.max(e.d,n.d):e.d:n?n.d:0)+1}var Su={stack:"dbcore",level:0,create:function(t){var e=t.schema.name,n=new ce(t.MIN_KEY,t.MAX_KEY);return k(k({},t),{table:function(r){var i=t.table(r),s=i.schema,o=s.primaryKey,a=o.extractKey,u=o.outbound,l=k(k({},i),{mutate:function(h){var m=h.trans,p=m.mutatedParts||(m.mutatedParts={}),d=function($){var E="idb://"+e+"/"+r+"/"+$;return p[E]||(p[E]=new ce)},y=d(""),b=d(":dels"),S=h.type,g=h.type==="deleteRange"?[h.range]:h.type==="delete"?[h.keys]:h.values.length<50?[[],h.values]:[],w=g[0],v=g[1],_=h.trans._cache;return i.mutate(h).then(function($){if(j(w)){S!=="delete"&&(w=$.results),y.addKeys(w);var E=Ds(w,_);!E&&S!=="add"&&b.addKeys(w),(E||v)&&Eu(d,s,E,v)}else if(w){var C={from:w.lower,to:w.upper};b.add(C),y.add(C)}else y.add(n),b.add(n),s.indexes.forEach(function(P){return d(P.name).add(n)});return $})}}),f=function(h){var m,p,d=h.query,y=d.index,b=d.range;return[y,new ce((m=b.lower)!==null&&m!==void 0?m:t.MIN_KEY,(p=b.upper)!==null&&p!==void 0?p:t.MAX_KEY)]},c={get:function(h){return[o,new ce(h.key)]},getMany:function(h){return[o,new ce().addKeys(h.keys)]},count:f,query:f,openCursor:f};return z(c).forEach(function(h){l[h]=function(m){var p=A.subscr;if(p){var d=function(_){var $="idb://"+e+"/"+r+"/"+_;return p[$]||(p[$]=new ce)},y=d(""),b=d(":dels"),S=c[h](m),g=S[0],w=S[1];if(d(g.name||"").add(w),!g.isPrimaryKey)if(h==="count")b.add(n);else{var v=h==="query"&&u&&m.values&&i.query(k(k({},m),{values:!1}));return i[h].apply(this,arguments).then(function(_){if(h==="query"){if(u&&m.values)return v.then(function(P){var M=P.result;return y.addKeys(M),_});var $=m.values?_.result.map(a):_.result;m.values?y.addKeys($):b.addKeys($)}else if(h==="openCursor"){var E=_,C=m.values;return E&&Object.create(E,{key:{get:function(){return b.addKey(E.primaryKey),E.key}},primaryKey:{get:function(){var P=E.primaryKey;return b.addKey(P),P}},value:{get:function(){return C&&y.addKey(E.primaryKey),E.value}}})}return _})}}return i[h].apply(this,arguments)}}),l}})}};function Eu(t,e,n,r){function i(s){var o=t(s.name||"");function a(l){return l!=null?s.extractKey(l):null}var u=function(l){return s.multiEntry&&j(l)?l.forEach(function(f){return o.addKey(f)}):o.addKey(l)};(n||r).forEach(function(l,f){var c=n&&a(n[f]),h=r&&a(r[f]);V(c,h)!==0&&(c!=null&&u(c),h!=null&&u(h))})}e.indexes.forEach(i)}var Nr=function(){function t(e,n){var r=this;this._middlewares={},this.verno=0;var i=t.dependencies;this._options=n=k({addons:t.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange},n),this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};var s=n.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var o={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:N,dbReadyPromise:null,cancelOpen:N,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};o.dbReadyPromise=new x(function(a){o.dbReadyResolve=a}),o.openCanceller=new x(function(a,u){o.cancelOpen=u}),this._state=o,this.name=e,this.on=kt(this,"populate","blocked","versionchange","close",{ready:[xr,N]}),this.on.ready.subscribe=is(this.on.ready.subscribe,function(a){return function(u,l){t.vip(function(){var f=r._state;if(f.openComplete)f.dbOpenError||x.resolve().then(u),l&&a(u);else if(f.onReadyBeingFired)f.onReadyBeingFired.push(u),l&&a(u);else{a(u);var c=r;l||a(function h(){c.on.ready.unsubscribe(u),c.on.ready.unsubscribe(h)})}})}}),this.Collection=Ka(this),this.Table=Oa(this),this.Transaction=Wa(this),this.Version=uu(this),this.WhereClause=ja(this),this.on("versionchange",function(a){a.newVersion>0?console.warn("Another connection wants to upgrade database '"+r.name+"'. Closing db now to resume the upgrade."):console.warn("Another connection wants to delete database '"+r.name+"'. Closing db now to resume the delete request."),r.close()}),this.on("blocked",function(a){!a.newVersion||a.newVersion<a.oldVersion?console.warn("Dexie.delete('"+r.name+"') was blocked"):console.warn("Upgrade '"+r.name+"' blocked by other connection holding version "+a.oldVersion/10)}),this._maxKey=xt(n.IDBKeyRange),this._createTransaction=function(a,u,l,f){return new r.Transaction(a,u,l,r._options.chromeTransactionDurability,f)},this._fireOnBlocked=function(a){r.on("blocked").fire(a),ft.filter(function(u){return u.name===r.name&&u!==r&&!u._state.vcFired}).map(function(u){return u.on("versionchange").fire(a)})},this.use(mu),this.use(gu),this.use(Su),this.use(bu),this.vip=Object.create(this,{_vip:{value:!0}}),s.forEach(function(a){return a(r)})}return t.prototype.version=function(e){if(isNaN(e)||e<.1)throw new T.Type("Given version is not a positive number");if(e=Math.round(e*10)/10,this.idbdb||this._state.isBeingOpened)throw new T.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var n=this._versions,r=n.filter(function(i){return i._cfg.version===e})[0];return r||(r=new this.Version(e),n.push(r),n.sort(Za),r.stores({}),this._state.autoSchema=!1,r)},t.prototype._whenReady=function(e){var n=this;return this.idbdb&&(this._state.openComplete||A.letThrough||this._vip)?e():new x(function(r,i){if(n._state.openComplete)return i(new T.DatabaseClosed(n._state.dbOpenError));if(!n._state.isBeingOpened){if(!n._options.autoOpen){i(new T.DatabaseClosed);return}n.open().catch(N)}n._state.dbReadyPromise.then(r,i)}).then(e)},t.prototype.use=function(e){var n=e.stack,r=e.create,i=e.level,s=e.name;s&&this.unuse({stack:n,name:s});var o=this._middlewares[n]||(this._middlewares[n]=[]);return o.push({stack:n,create:r,level:i??10,name:s}),o.sort(function(a,u){return a.level-u.level}),this},t.prototype.unuse=function(e){var n=e.stack,r=e.name,i=e.create;return n&&this._middlewares[n]&&(this._middlewares[n]=this._middlewares[n].filter(function(s){return i?s.create!==i:r?s.name!==r:!1})),this},t.prototype.open=function(){return du(this)},t.prototype._close=function(){var e=this._state,n=ft.indexOf(this);if(n>=0&&ft.splice(n,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}e.dbReadyPromise=new x(function(r){e.dbReadyResolve=r}),e.openCanceller=new x(function(r,i){e.cancelOpen=i})},t.prototype.close=function(){this._close();var e=this._state;this._options.autoOpen=!1,e.dbOpenError=new T.DatabaseClosed,e.isBeingOpened&&e.cancelOpen(e.dbOpenError)},t.prototype.delete=function(){var e=this,n=arguments.length>0,r=this._state;return new x(function(i,s){var o=function(){e.close();var a=e._deps.indexedDB.deleteDatabase(e.name);a.onsuccess=K(function(){fu(e._deps,e.name),i()}),a.onerror=oe(s),a.onblocked=e._fireOnBlocked};if(n)throw new T.InvalidArgument("Arguments not allowed in db.delete()");r.isBeingOpened?r.dbReadyPromise.then(o):o()})},t.prototype.backendDB=function(){return this.idbdb},t.prototype.isOpen=function(){return this.idbdb!==null},t.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"},t.prototype.hasFailed=function(){return this._state.dbOpenError!==null},t.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(t.prototype,"tables",{get:function(){var e=this;return z(this._allTables).map(function(n){return e._allTables[n]})},enumerable:!1,configurable:!0}),t.prototype.transaction=function(){var e=pu.apply(this,arguments);return this._transaction.apply(this,e)},t.prototype._transaction=function(e,n,r){var i=this,s=A.trans;(!s||s.db!==this||e.indexOf("!")!==-1)&&(s=null);var o=e.indexOf("?")!==-1;e=e.replace("!","").replace("?","");var a,u;try{if(u=n.map(function(f){var c=f instanceof i.Table?f.name:f;if(typeof c!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return c}),e=="r"||e===Cn)a=Cn;else if(e=="rw"||e==Tn)a=Tn;else throw new T.InvalidArgument("Invalid transaction mode: "+e);if(s){if(s.mode===Cn&&a===Tn)if(o)s=null;else throw new T.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");s&&u.forEach(function(f){if(s&&s.storeNames.indexOf(f)===-1)if(o)s=null;else throw new T.SubTransaction("Table "+f+" not included in parent transaction.")}),o&&s&&!s.active&&(s=null)}}catch(f){return s?s._promise(null,function(c,h){h(f)}):L(f)}var l=ks.bind(null,this,a,u,s,r);return s?s._promise(a,l,"lock"):A.trans?tt(A.transless,function(){return i._whenReady(l)}):this._whenReady(l)},t.prototype.table=function(e){if(!Q(this._allTables,e))throw new T.InvalidTable("Table "+e+" does not exist");return this._allTables[e]},t}(),xu=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Au=function(){function t(e){this._subscribe=e}return t.prototype.subscribe=function(e,n,r){return this._subscribe(!e||typeof e=="function"?{next:e,error:n,complete:r}:e)},t.prototype[xu]=function(){return this},t}();function Os(t,e){return z(e).forEach(function(n){var r=t[n]||(t[n]=new ce);ln(r,e[n])}),t}function $u(t){return new Au(function(e){var n=_r(t);function r(m){n&&et();var p=function(){return Ae(t,{subscr:m,trans:null})},d=A.trans?tt(A.transless,p):p();return n&&d.then(ve,ve),d}var i=!1,s={},o={},a={get closed(){return i},unsubscribe:function(){i=!0,Ce.storagemutated.unsubscribe(c)}};e.start&&e.start(a);var u=!1,l=!1;function f(){return z(o).some(function(m){return s[m]&&_u(s[m],o[m])})}var c=function(m){Os(s,m),f()&&h()},h=function(){if(!(u||i)){s={};var m={},p=r(m);l||(Ce(Et,c),l=!0),u=!0,Promise.resolve(p).then(function(d){u=!1,!i&&(f()?h():(s={},o=m,e.next&&e.next(d)))},function(d){u=!1,e.error&&e.error(d),a.unsubscribe()})}};return h(),a})}var hr;try{hr={indexedDB:I.indexedDB||I.mozIndexedDB||I.webkitIndexedDB||I.msIndexedDB,IDBKeyRange:I.IDBKeyRange||I.webkitIDBKeyRange}}catch{hr={indexedDB:null,IDBKeyRange:null}}var Re=Nr;Qe(Re,k(k({},vn),{delete:function(t){var e=new Re(t,{addons:[]});return e.delete()},exists:function(t){return new Re(t,{addons:[]}).open().then(function(e){return e.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(t){try{return lu(Re.dependencies).then(t)}catch{return L(new T.MissingAPI)}},defineClass:function(){function t(e){W(this,e)}return t},ignoreTransaction:function(t){return A.trans?tt(A.transless,t):t()},vip:lr,async:function(t){return function(){try{var e=cr(t.apply(this,arguments));return!e||typeof e.then!="function"?x.resolve(e):e}catch(n){return L(n)}}},spawn:function(t,e,n){try{var r=cr(t.apply(n,e||[]));return!r||typeof r.then!="function"?x.resolve(r):r}catch(i){return L(i)}},currentTransaction:{get:function(){return A.trans||null}},waitFor:function(t,e){var n=x.resolve(typeof t=="function"?Re.ignoreTransaction(t):t).timeout(e||6e4);return A.trans?A.trans.waitFor(n):n},Promise:x,debug:{get:function(){return ue},set:function(t){cs(t,t==="dexie"?function(){return!0}:xs)}},derive:Xe,extend:W,props:Qe,override:is,Events:kt,on:Ce,liveQuery:$u,extendObservabilitySet:Os,getByKeyPath:de,setByKeyPath:re,delByKeyPath:ia,shallowClone:as,deepClone:Ct,getObjectDiff:Mr,cmp:V,asap:ss,minKey:rr,addons:[],connections:ft,errnames:Er,dependencies:hr,semVer:di,version:di.split(".").map(function(t){return parseInt(t)}).reduce(function(t,e,n){return t+e/Math.pow(10,n*2)})}));Re.maxKey=xt(Re.dependencies.IDBKeyRange);typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Ce(Et,function(t){if(!he){var e;mn?(e=document.createEvent("CustomEvent"),e.initCustomEvent(_e,!0,!0,t)):e=new CustomEvent(_e,{detail:t}),he=!0,dispatchEvent(e),he=!1}}),addEventListener(_e,function(t){var e=t.detail;he||cn(e)}));function cn(t){var e=he;try{he=!0,Ce.storagemutated.fire(t)}finally{he=e}}var he=!1;if(typeof BroadcastChannel<"u"){var Ht=new BroadcastChannel(_e);typeof Ht.unref=="function"&&Ht.unref(),Ce(Et,function(t){he||Ht.postMessage(t)}),Ht.onmessage=function(t){t.data&&cn(t.data)}}else if(typeof self<"u"&&typeof navigator<"u"){Ce(Et,function(t){try{he||(typeof localStorage<"u"&&localStorage.setItem(_e,JSON.stringify({trig:Math.random(),changedParts:t})),typeof self.clients=="object"&&Un([],self.clients.matchAll({includeUncontrolled:!0}),!0).forEach(function(e){return e.postMessage({type:_e,changedParts:t})}))}catch{}}),typeof addEventListener<"u"&&addEventListener("storage",function(t){if(t.key===_e){var e=JSON.parse(t.newValue);e&&cn(e.changedParts)}});var _i=self.document&&navigator.serviceWorker;_i&&_i.addEventListener("message",Cu)}function Cu(t){var e=t.data;e&&e.type===_e&&cn(e.changedParts)}x.rejectionMapper=da;cs(ue,xs);class Ot extends Error{constructor(e){super(e),this.name="SpaRouterError"}}class Si extends Ot{constructor(e){super(e),this.name="WindowEventConsolidationError"}}const gn="locationchange";let Ei=!1;const Tu=window.history.pushState;function xi(...t){const e=Tu.apply(window.history,t);return window.dispatchEvent(new Event(gn)),e}const Pu=window.history.replaceState;function Ai(...t){const e=Pu.apply(window.history,t);return window.dispatchEvent(new Event(gn)),e}function Ru(){if(!Ei){if(window.history.pushState===xi)throw new Si("The consolidation module thinks that window events have not been consolidated yet but window.history.pushState has already been overridden. Does this module have two copies in your repo?");if(window.history.replaceState===Ai)throw new Si("The consolidation module thinks that window events have not been consolidated yet but window.history.replaceState has already been overridden. Does this module have two copies in your repo?");Ei=!0,window.history.pushState=xi,window.history.replaceState=Ai,window.addEventListener("popstate",()=>{window.dispatchEvent(new Event(gn))})}}function ku(t){return Array.from(t.entries()).reduce((e,n)=>(e[n[0]]=n[1],e),{})}function Du(t){const e=Object.entries(t).reduce((n,r)=>{const i=`${r[0]}=${r[1]}`;return`${n}&${i}`},"");return new URLSearchParams(e)}function Ou(t){const n=(t?window.location.pathname.replace(t,""):window.location.pathname).split("/").filter(o=>!!o),i=window.location.search?ku(new URLSearchParams(window.location.search)):void 0,s=window.location.hash||void 0;return{paths:n,search:i,hash:s}}class Mu extends Ot{constructor(e){super(e),this.name="SanitizationDepthMaxed"}}function Ms(t,e){if(t.paths.join(" ")!==e.paths.join(" "))return!1;if(typeof t.search=="object"&&typeof e.search=="object"){const n=Object.entries(t.search).join(" "),r=Object.entries(e.search).join(" ");if(n!==r)return!1}else if(t.search!==e.search)return!1;return t.hash===e.hash}const $i=6;function Ci(t,e){const n=t.getCurrentRawRoutes();if(t.sanitizationDepth>$i)throw new Mu(`Route sanitization depth has exceed the max of ${$i} with ${JSON.stringify(n)}`);const r=t.sanitizeFullRoute(n);if(Ms(r,n))t.sanitizationDepth=0,e?e(r):t.listeners.forEach(i=>{i(r)});else return t.sanitizationDepth++,t.setRoutes(r,!0)}class On extends Ot{constructor(e){super(e),this.name="InvalidRouterInitParamsError"}}function Bu(t){if("routeBase"in t&&typeof t.routeBase!="string"&&t.routeBase!=null)throw new On(`Invalid type for router init params "routeBase" property. Expected string or undefined but got "${t.routeBase}" with type "${typeof t.routeBase}".`);if("routeSanitizer"in t&&typeof t.routeSanitizer!="function"&&t.routeSanitizer!=null)throw new On(`Invalid type for router init params "routeSanitizer" property. Expected a function or undefined but got "${t.routeSanitizer}" with type "${typeof t.routeSanitizer}".`);if("maxListenerCount"in t&&(typeof t.maxListenerCount!="number"||isNaN(t.maxListenerCount))&&t.maxListenerCount!=null)throw new On(`Invalid type for router init params "maxListenerCount" property. Expected a number or undefined but got "${t.maxListenerCount}" with type "${typeof t.maxListenerCount}".`)}function Nu(t,e,n,r=!1){const i=Bs(t,e,n);r?window.history.replaceState(void 0,"",i):window.history.pushState(void 0,"",i)}function Bs(t,e,n=""){var r;if(!n&&e!=null)throw new Ot("Route base regexp was defined but routeBase string was not provided.");const i=Iu(e)?`/${n}`:"",s=t.search?Du(t.search).toString():"",o=s?`?${s}`:"",a=!((r=t.hash)===null||r===void 0)&&r.startsWith("#")?"":"#",u=t.hash?`${a}${t.hash}`:"";return`${i}/${t.paths.join("/")}${o}${u}`}function Iu(t){return!!(t&&window.location.pathname.match(t))}function Ku(t={}){var e;Bu(t),Ru();const n=(e=t.routeBase)===null||e===void 0?void 0:e.replace(/\/+$/,""),r=n?new RegExp(`^\\/${t.routeBase}`):void 0;let i=!1;const s={listeners:new Set,initParams:t,sanitizeFullRoute:o=>{const a={hash:void 0,search:void 0,...o};return t.routeSanitizer?t.routeSanitizer(a):a},setRoutes:(o,a=!1,u=!1)=>{const l=s.getCurrentRawRoutes(),f={...l,...o},c=s.sanitizeFullRoute(f);if(!(!u&&Ms(l,c)))return Nu(c,r,n,a)},createRoutesUrl:o=>Bs(o,r,n),getCurrentRawRoutes:()=>Ou(r),addRouteListener:(o,a)=>{if(t.maxListenerCount&&s.listeners.size>=t.maxListenerCount)throw new Ot(`Tried to exceed route listener max of ${t.maxListenerCount}.`);return s.listeners.add(a),i||(window.addEventListener(gn,()=>Ci(s)),i=!0),o&&Ci(s,a),a},hasRouteListener:o=>s.listeners.has(o),removeRouteListener:o=>s.listeners.delete(o),sanitizationDepth:0};return s}const Ns=Ku({routeBase:"resizable-image-element"}),zu=["https://files.porsche.com/filestore/image/multimedia/none/992-gt3-modelimage-sideshot/model/765dfc51-51bc-11eb-80d1-005056bbdc38/porsche-model.png"],Lu="resizable-image-element-storage";class Hu extends Nr{constructor(){super(Lu),this.version(1).stores({storedUrls:"&index"})}}const Mn=new Hu,Ti={async set(t){const e=fn(t).map((n,r)=>({index:r,url:n}));await Mn.storedUrls.clear(),await Mn.storedUrls.bulkPut(e)},async get(){const e=(await Mn.storedUrls.toArray()).map(r=>r.url),n=fn(e);return Fu(n.length?n:zu)}};function Fu(t){var e,n;try{const r=fn(((n=(e=Ns.getCurrentRawRoutes().search)==null?void 0:e.imageUrls)==null?void 0:n.split(","))??[]);return Array.isArray(r)&&r.length?r:t}catch{return t}}function fn(t){return t.map(e=>e.replace(/^"/,"").replace(/"$/,"").trim()).filter(js)}const{defineElement:Uu,defineElementNoInputs:ju}=Oo(),Ft=Uu()({tagName:"vir-url-input",events:{urlsChange:Ao()},styles:lt`
        :host {
            display: block;
        }

        textarea {
            box-sizing: border-box;
            width: 100%;
            height: 100%;
            max-height: 100%;
            height: 150px;
            font: inherit;
            outline: none;
            border: 2px solid #ccc;
            border-radius: 4px;

            white-space: pre;
            overflow-wrap: normal;
            overflow-x: scroll;
            padding: 8px;
        }

        textarea:focus {
            border-color: blue;
        }
    `,renderCallback:({inputs:t,dispatch:e,events:n,host:r})=>{const i=r.shadowRoot.querySelector("textarea"),s=t.urls.join(`
`),o=s+`
`;return i&&(i==null?void 0:i.value)!==s&&(i.value=s),J`
            <textarea
                ${en("input",a=>{const l=a.currentTarget.value.split(`
`).map(f=>f.trim().replace(/,+$/,""));e(new n.urlsChange(l))})}
                ${en("blur",()=>{i&&(i.value=o)})}
                .value=${i&&i.matches(":focus")?s:o}
            ></textarea>
        `}}),it={max:{width:300,height:600},min:{width:300,height:150}};ju({tagName:"vir-example-app",stateInit:{imageUrls:Fi(Ti.get()),constraints:void 0,router:Ns,urlUpdateDebounce:{promise:void 0,lastSearch:void 0}},styles:lt`
        :host {
            display: flex;
            flex-direction: column;
            height: 100%;
            width: 100%;
            box-sizing: border-box;
            padding: 16px;
        }

        .all-image-containers {
            display: flex;
            flex-direction: column;
            gap: 32px;
        }

        ${Vt} {
            border: 1px solid blue;
            background-color: rgb(241, 241, 241);
            border-radius: 8px;
            flex-shrink: 0;
        }

        .images-container {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .images-container > * {
            flex-shrink: 0;
        }

        label {
            display: flex;
            align-items: flex-start;
            flex-direction: column;
            font: inherit;
            font-size: 1.4em;
            gap: 4px;
        }

        .inline-label {
            flex-direction: row;
            align-items: center;
        }

        p {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .constraint-controls {
            display: flex;
            gap: 8px;
        }

        input {
            font: inherit;
        }

        .constraint-wrapper {
            border: 2px solid;
            flex-shrink: 0;
            position: relative;
        }

        .constraint-wrapper.max {
            display: flex;
            align-items: center;
            justify-content: center;
            border-color: red;
        }

        .constraint-wrapper.min {
            border-color: lime;
            pointer-events: none;
        }

        .constraint-wrapper .min-wrapper {
            position: absolute;
            pointer-events: none;
            top: 0;
            left: 0;
            height: 100%;
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .constraint-wrapper a {
            cursor: pointer;
        }
    `,renderCallback:({state:t,updateState:e})=>{if(!t.constraints){const o=t.router.getCurrentRawRoutes().search;e({constraints:{min:{width:Number(o==null?void 0:o.minW)||it.min.width,height:Number(o==null?void 0:o.minH)||it.min.height},max:{width:Number(o==null?void 0:o.maxW)||it.max.width,height:Number(o==null?void 0:o.maxH)||it.max.height}}})}const n=t.constraints??it,r=Array.isArray(t.imageUrls)?t.imageUrls:[];function i(){return{...t.router.getCurrentRawRoutes().search,minW:String(n.min.width),minH:String(n.min.height),maxW:String(n.max.width),maxH:String(n.max.height),...r.length?{imageUrls:r.join(",")}:{}}}function s(o,a,u){e({constraints:{...n,[a]:{...n[a],[u]:Number(o.value)||0}}})}return!t.urlUpdateDebounce.promise&&(!t.urlUpdateDebounce.lastSearch||!Di(i(),t.urlUpdateDebounce.lastSearch))&&e({urlUpdateDebounce:{promise:Ut(1e3).then(()=>{const o=i();try{t.router.setRoutes({search:o},!0)}catch(a){console.warn(a)}e({urlUpdateDebounce:{promise:void 0,lastSearch:o}})}),lastSearch:i()}}),J`
            <a href="https://github.com/electrovir/resizable-image-element">
                <h1>resizable-image-element</h1>
            </a>
            <p>
                Add more image URLs to the input below:
            </p>
            <${Ft}
                ${gr(Ft,{urls:r})}
                ${en(Ft.events.urlsChange,o=>{const a=o.detail;Ti.set(a),e({imageUrls:{resolvedValue:o.detail}})})}
            ></${Ft}>
            <p>
                ${["min","max"].map(o=>{const a=["height","width"].map(u=>{const l=[Bn(o),Bn(u)].join(" "),f=n[o][u];return J`
                            <label>
                                ${l}
                                <br />
                                ${ne(f)}
                                <br />
                                <input
                                    type="range"
                                    max="1000"
                                    min="20"
                                    .value=${f}
                                    ${en("input",c=>{s(c.currentTarget,o,u)})}
                                />
                            </label>
                        `});return J`
                        <div class="constraint-controls">${a}</div>
                    `})}
            </p>
            <div class="images-container">
                ${Vu(n,t.imageUrls)}
            </div>
        `}});function Vu(t,e){return Hn(e,"Loading...",n=>fn(n).map(r=>{const i=`
                height: ${ne(t.max.height)};
                max-height: ${ne(t.max.height)};
                width: ${ne(t.max.width)};
                max-width: ${ne(t.max.width)}`,s=`height: ${ne(t.min.height)}; width: ${ne(t.min.width)}`;return J`
                <div
                    class="constraint-wrapper max"
                    style=${i}
                >
                    <a
                        target="_blank"
                        rel="noopener noreferrer"
                        href=${r}
                    >
                        <${Vt}
                            ${gr(Vt,{imageUrl:r,max:t.max,min:t.min})}
                        ></${Vt}>
                    </a>
                    <div
                        class="min-wrapper"
                    >
                        <div
                            class="constraint-wrapper min"
                            style=${s}
                        ></div>
                    </div>
                </div>
            `}))}
